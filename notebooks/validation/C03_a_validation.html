
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Validating a Reconstruction &#8212; Assimilating PAGES 2k records with LinkedEarth tools</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/validation/C03_a_validation';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Proxy Database Forensics" href="C03_b_comparison.html" />
    <link rel="prev" title="Run Data Assimilation" href="../data_assimilation/C02_b_DA_with_individual_seasonality.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
  
    <p class="title logo__title">Assimilating PAGES 2k records with LinkedEarth tools</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Assimilating PAGES 2k records with LinkedEarth tools
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Assembly</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data_assembly/C01_a_db_assembly_Tardif2019_pickle.html">Database Assembly using the LMRv2.1 pickle file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_assembly/C01_b_db_assembly_cfr_PAGES2k.html">Database Assembly using cfrâ€™s built in PAGES 2k database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_assembly/C01_d_db_assembly_LiPDGraph.html">Assembling the proxy database from the LiPDGraph</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Assimilation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data_assimilation/C02_a_DA_with_class_based_seasonality.html">Run Data Assimilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_assimilation/C02_b_DA_with_individual_seasonality.html">Run Data Assimilation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Validation and Comparison</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Validating a Reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="C03_b_comparison.html">Proxy Database Forensics</a></li>
<li class="toctree-l1"><a class="reference internal" href="C04_validating_PReSto2k.html">Validating PReSto2k</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tanaya-g/pages2k_cfr_pb" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tanaya-g/pages2k_cfr_pb/issues/new?title=Issue%20on%20page%20%2Fnotebooks/validation/C03_a_validation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/validation/C03_a_validation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Validating a Reconstruction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-recon-job">Load Recon Job</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-gmst-from-our-recon-job">Load GMST from our Recon Job</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-lmr-offline-original-lmrv2-1">Load LMR offline (original LMRv2.1)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-both-versions-of-lmr-to-see-comparison">Plot both versions of LMR to see comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-using-pens">Validate Using PENS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-gmst-against-instrumental-datasets">Validating GMST Against Instrumental Datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-against-giss-surface-temperature-analysis-gistemp">Validate against GISS Surface Temperature Analysis (GISTEMP)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-against-hadcrut5">Validate against HadCRUT5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-against-berkeley-earth-surface-temperature-best">Validate against Berkeley Earth Surface Temperature (BEST)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-consensus">Plot Consensus</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-climate-field">Validate Climate Field</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-field-reconstruction">Load field reconstruction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-reproduced">Loading reproduced</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-our-reconstruction-using-best">Validating our reconstruction using BEST</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-the-original-lmrv2-1-using-best">Validating the original LMRv2.1 using BEST</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-our-reconstruction-against-original-lmrv2-1">Validating our Reconstruction against original LMRv2.1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="validating-a-reconstruction">
<h1>Validating a Reconstruction<a class="headerlink" href="#validating-a-reconstruction" title="Link to this heading">#</a></h1>
<p>This notebook compares our paleoclimate reconstruction to both:</p>
<ul class="simple">
<li><p>The original LMRv2.1 (offline) reconstruction</p></li>
<li><p>Multiple instrumental datasets (HadCRUT5, GISTEMP, Berkeley Earth)</p></li>
</ul>
<p>We assess the quality of the reconstruction using:</p>
<ul class="simple">
<li><p>Global mean surface temperature (GMST) comparisons (median and spread)</p></li>
<li><p>Climate field skill metrics (correlation, coefficient of efficiency)</p></li>
<li><p>Ensemble similarity via the plume distance framework of <a class="reference external" href="https://journals.ametsoc.org/view/journals/clim/38/5/JCLI-D-24-0101.1.xml">Emile-Geay et al. (2025)</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span><span class="w"> </span><span class="nn">cfr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cfr</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pens</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
2025.5.7
</pre></div>
</div>
</div>
</div>
<section id="load-recon-job">
<h2>Load Recon Job<a class="headerlink" href="#load-recon-job" title="Link to this heading">#</a></h2>
<p>Load our reconstruction. We only need to see <code class="docutils literal notranslate"><span class="pre">'tas_gm'</span></code> which is the global mean surface temperature (ensemble time series) and <code class="docutils literal notranslate"><span class="pre">'tas'</span></code> which is the surface temperature climate field.</p>
<blockquote>
<div><p>Note: Here we are validating the reconstruction using the proxy database derived from Step 2b filtered by archive and resolution. Results will vary slightly by variant of Step 2.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ReconRes</span><span class="p">(</span><span class="s1">&#39;./recons/lmr_reproduce_pda_ptype_res/&#39;</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="s1">&#39;tas&#39;</span><span class="p">,</span> <span class="s1">&#39;tas_gm&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-gmst-from-our-recon-job">
<h2>Load GMST from our Recon Job<a class="headerlink" href="#load-gmst-from-our-recon-job" title="Link to this heading">#</a></h2>
<p>Here just loading the <code class="docutils literal notranslate"><span class="pre">'tas_gm'</span></code> component of our reconstruction</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_ts</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">recons</span><span class="p">[</span><span class="s1">&#39;tas_gm&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-lmr-offline-original-lmrv2-1">
<h2>Load LMR offline (original LMRv2.1)<a class="headerlink" href="#load-lmr-offline-original-lmrv2-1" title="Link to this heading">#</a></h2>
<p>We can do this using Pangeo-Forge, but this one is done by downloading the data directly from the <a class="reference external" href="https://www.atmos.uw.edu/~hakim/lmr/LMRv2/index.html">LMR Data Page</a>. We can then load the GMT  and take the mean across ensembles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lmr_off</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./prev_data/gmt_MCruns_ensemble_full_LMRv2.1.nc&#39;</span><span class="p">)</span>
<span class="n">lmr_off</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 16MB
Dimensions:  (time: 2001, MCrun: 20, members: 100)
Coordinates:
  * time     (time) object 16kB 0000-01-01 00:00:00 ... 2000-01-01 00:00:00
Dimensions without coordinates: MCrun, members
Data variables:
    gmt      (time, MCrun, members) float32 16MB ...
Attributes:
    description:  Last Millennium Reanalysis climate field reconstruction for...
    experiment:   productionFinal2_gisgpcc_ccms4_LMRdbv1.1.0_tas
    comment:      File contains full ensemble values for each Monte-Carlo rec...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-34319e34-8b21-4466-bacf-a4b507b25794' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-34319e34-8b21-4466-bacf-a4b507b25794' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2001</li><li><span>MCrun</span>: 20</li><li><span>members</span>: 100</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-dbbe520c-4298-4839-bee4-012a8bfaf56f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dbbe520c-4298-4839-bee4-012a8bfaf56f' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>0000-01-01 00:00:00 ... 2000-01-...</div><input id='attrs-db2bf220-e2e1-4b20-9062-ced178936eee' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-db2bf220-e2e1-4b20-9062-ced178936eee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-386f749b-a756-4fde-a5d1-1e8f36b08f2a' class='xr-var-data-in' type='checkbox'><label for='data-386f749b-a756-4fde-a5d1-1e8f36b08f2a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>actual_range :</span></dt><dd>[     0. 730000.]</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(0, 1, 1, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1, 1, 1, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2, 1, 1, 0, 0, 0, 0, has_year_zero=True), ...,
       cftime.DatetimeNoLeap(1998, 1, 1, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1999, 1, 1, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2000, 1, 1, 0, 0, 0, 0, has_year_zero=True)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f1512a8b-6974-4eaf-b94e-ee882f27857a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f1512a8b-6974-4eaf-b94e-ee882f27857a' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>gmt</span></div><div class='xr-var-dims'>(time, MCrun, members)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8e9203ed-aece-40bf-a764-102038e17f68' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8e9203ed-aece-40bf-a764-102038e17f68' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae3a027a-d948-47c7-a33e-bb587a2a4f15' class='xr-var-data-in' type='checkbox'><label for='data-ae3a027a-d948-47c7-a33e-bb587a2a4f15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>var_desc :</span></dt><dd>Air temperature</dd><dt><span>long_name :</span></dt><dd>Global-Mean Air Temperature at Surface</dd><dt><span>standard_name :</span></dt><dd>global_mean_air_temperature</dd><dt><span>units :</span></dt><dd>degK</dd><dt><span>level_desc :</span></dt><dd>2m</dd><dt><span>statistic :</span></dt><dd>E</dd><dt><span>GRIB_id :</span></dt><dd></dd><dt><span>GRIB_name :</span></dt><dd></dd><dt><span>valid_range :</span></dt><dd>[-4.  4.]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>actual_range :</span></dt><dd>[-2.651227    0.94426453]</dd></dl></div><div class='xr-var-data'><pre>[4002000 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4170bff9-00f6-44e3-925d-3e660ac54c6e' class='xr-section-summary-in' type='checkbox'  ><label for='section-4170bff9-00f6-44e3-925d-3e660ac54c6e' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-351b907c-b40c-4e84-bc67-de6f88cd2626' class='xr-index-data-in' type='checkbox'/><label for='index-351b907c-b40c-4e84-bc67-de6f88cd2626' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(CFTimeIndex([0000-01-01 00:00:00, 0001-01-01 00:00:00, 0002-01-01 00:00:00,
             0003-01-01 00:00:00, 0004-01-01 00:00:00, 0005-01-01 00:00:00,
             0006-01-01 00:00:00, 0007-01-01 00:00:00, 0008-01-01 00:00:00,
             0009-01-01 00:00:00,
             ...
             1991-01-01 00:00:00, 1992-01-01 00:00:00, 1993-01-01 00:00:00,
             1994-01-01 00:00:00, 1995-01-01 00:00:00, 1996-01-01 00:00:00,
             1997-01-01 00:00:00, 1998-01-01 00:00:00, 1999-01-01 00:00:00,
             2000-01-01 00:00:00],
            dtype=&#x27;object&#x27;, length=2001, calendar=&#x27;noleap&#x27;, freq=&#x27;YS-JAN&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ec3aa14d-9f94-49df-bd8b-bff2579bf3b7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ec3aa14d-9f94-49df-bd8b-bff2579bf3b7' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Last Millennium Reanalysis climate field reconstruction for variable: gmt</dd><dt><span>experiment :</span></dt><dd>productionFinal2_gisgpcc_ccms4_LMRdbv1.1.0_tas</dd><dt><span>comment :</span></dt><dd>File contains full ensemble values for each Monte-Carlo reconstruction (MCrun)</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ens_values</span> <span class="o">=</span> <span class="n">lmr_off</span><span class="o">.</span><span class="n">gmt</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">ensemble</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MCrun&#39;</span><span class="p">,</span> <span class="s1">&#39;members&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Shape: (time, MCrun*members)</span>
<span class="n">time_values</span> <span class="o">=</span> <span class="n">lmr_off</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">year</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_values</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lmr_ens</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">EnsTS</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ens_values</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Temperature Anomaly (Â°C)&#39;</span><span class="p">)</span>
<span class="n">lmr_ens</span><span class="o">.</span><span class="n">plot_qs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1200x400 with 1 Axes&gt;,
 &lt;Axes: xlabel=&#39;Year (CE)&#39;, ylabel=&#39;Temperature Anomaly (Â°C)&#39;&gt;)
</pre></div>
</div>
<img alt="../../_images/b7916737a89d7662496f1b3a6d2e9d5a1221f5841da1c4707ff787d68ea71a2f.png" src="../../_images/b7916737a89d7662496f1b3a6d2e9d5a1221f5841da1c4707ff787d68ea71a2f.png" />
</div>
</div>
</section>
<section id="plot-both-versions-of-lmr-to-see-comparison">
<h2>Plot both versions of LMR to see comparison<a class="headerlink" href="#plot-both-versions-of-lmr-to-see-comparison" title="Link to this heading">#</a></h2>
<p>We want to see whether the general shape of the two reconstructions match since we are of course, trying to reproduce it as closely as possible. Mainly, we want to see if the varability is similar between reconstructions and see if they both accurately identified the same climate extremes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">res_ts</span><span class="o">.</span><span class="n">plot_qs</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;LMR Reproduced CFR Global Mean Temperature&#39;</span><span class="p">)</span>

<span class="n">lmr_ens</span><span class="o">.</span><span class="n">plot_qs</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span> 
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;LMRv2.1 Global Mean Temperature&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5a1c04a0504b26cc9193488ce4fee0f9e586c2acacde119643c5b16873f8d6d1.png" src="../../_images/5a1c04a0504b26cc9193488ce4fee0f9e586c2acacde119643c5b16873f8d6d1.png" />
</div>
</div>
<p>The ensemble distributions, as plotted here, look very similar, which is encouraging. Let us quantify that using the plume distance framework.</p>
</section>
<section id="validate-using-pens">
<h2>Validate Using PENS<a class="headerlink" href="#validate-using-pens" title="Link to this heading">#</a></h2>
<p>To quantitatively compare the original LMRv2.1 ensemble to the version reproduced using <code class="docutils literal notranslate"><span class="pre">cfr</span></code>, we apply the plume distance framework introduced by <a class="reference external" href="https://journals.ametsoc.org/view/journals/clim/38/5/JCLI-D-24-0101.1.xml">Emile-Geay et al. (2025)</a> using the <code class="docutils literal notranslate"><span class="pre">pens</span></code> package.</p>
<p>This framework compares collections of climate trajectories (plumes) by evaluating:</p>
<ul class="simple">
<li><p><strong>Intra-ensemble distances</strong>, which describe the spread of trajectories within an ensemble.</p></li>
<li><p><strong>Inter-ensemble distances</strong>, which measure differences between two ensembles.</p></li>
<li><p>The <strong>plume distance</strong>, a summary metric (Â°C) that captures the degree of similarity (or dissimilarity) between two plumes while accounting for internal variability.</p></li>
</ul>
<p>We compute these distances using the GMST ensembles from the original LMRv2.1 and our <code class="docutils literal notranslate"><span class="pre">cfr</span></code> reproduction. Both are converted into <code class="docutils literal notranslate"><span class="pre">pens.EnsembleTS</span></code> objects for ease of comparison.</p>
<blockquote>
<div><p>The closer the plume distance is to zero, the more statistically similar the ensembles are.</p>
</div></blockquote>
<p>The code computes and visualizes the intra and inter-ensemble distances (within LMRv2.1 and the reproduction) and highlights the plume distance on the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pens</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="n">pens</span><span class="o">.</span><span class="n">set_style</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert cfr EnsTS to pens EnsTS</span>
<span class="n">glob_pens</span> <span class="o">=</span> <span class="n">pens</span><span class="o">.</span><span class="n">EnsembleTS</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">lmr_ens</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">lmr_ens</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">glob_pens</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Original LMR&#39;</span>
<span class="n">glob_pens</span><span class="o">.</span><span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;years&#39;</span>
<span class="n">glob_pens</span><span class="o">.</span><span class="n">value_name</span> <span class="o">=</span> <span class="s1">&#39;GMST&#39;</span>
<span class="n">glob_pens</span><span class="o">.</span><span class="n">value_unit</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\N{DEGREE SIGN}</span><span class="s1">C&#39;</span>

<span class="n">res_pens</span> <span class="o">=</span> <span class="n">pens</span><span class="o">.</span><span class="n">EnsembleTS</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">res_ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">res_ts</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">res_pens</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Reproduced LMR&#39;</span>
<span class="n">res_pens</span><span class="o">.</span><span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;years&#39;</span>
<span class="n">res_pens</span><span class="o">.</span><span class="n">value_name</span> <span class="o">=</span> <span class="s1">&#39;GMST&#39;</span>
<span class="n">res_pens</span><span class="o">.</span><span class="n">value_unit</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\N{DEGREE SIGN}</span><span class="s1">C&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Align time dimension for both EnsTS</span>

<span class="n">glob_time</span> <span class="o">=</span> <span class="n">lmr_ens</span><span class="o">.</span><span class="n">time</span>
<span class="n">res_time</span> <span class="o">=</span> <span class="n">res_ts</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span>

<span class="n">common_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">glob_time</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">res_time</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="n">common_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">glob_time</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">res_time</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># Create time range array</span>
<span class="n">timespan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">common_start</span><span class="p">,</span> <span class="n">common_end</span><span class="p">])</span>

<span class="c1"># Slice to common period</span>
<span class="n">glob_pens_aligned</span> <span class="o">=</span> <span class="n">glob_pens</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
<span class="n">res_pens_aligned</span> <span class="o">=</span> <span class="n">res_pens</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">orig_intra</span> <span class="o">=</span> <span class="n">glob_pens_aligned</span><span class="o">.</span><span class="n">distance</span><span class="p">()</span>
<span class="n">repro_intra</span> <span class="o">=</span> <span class="n">res_pens_aligned</span><span class="o">.</span><span class="n">distance</span><span class="p">()</span>

<span class="c1"># Calculate inter-ensemble distance </span>
<span class="n">inter_dist</span> <span class="o">=</span> <span class="n">glob_pens_aligned</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">res_pens_aligned</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    
<span class="c1"># Calculate plume distance </span>
<span class="n">plume_dist</span> <span class="o">=</span> <span class="n">glob_pens_aligned</span><span class="o">.</span><span class="n">plume_distance</span><span class="p">(</span><span class="n">res_pens_aligned</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing intra-ensemble distance among possible pairs: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1999000/1999000 [00:41&lt;00:00, 48146.60it/s]
Computing intra-ensemble distance among possible pairs: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12497500/12497500 [03:56&lt;00:00, 52881.11it/s]
Computing inter-ensemble distance: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2000/2000 [03:28&lt;00:00,  9.58it/s]
Computing inter-ensemble distance: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2000/2000 [03:29&lt;00:00,  9.56it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distances between ensembles:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original intra-ensemble distance : </span><span class="si">{</span><span class="n">orig_intra</span><span class="si">}</span><span class="s2">,\ len=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">orig_intra</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reproduced intra-ensemble distance: </span><span class="si">{</span><span class="n">repro_intra</span><span class="si">}</span><span class="s2">,\ len=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">repro_intra</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inter-ensemble distance: </span><span class="si">{</span><span class="n">inter_dist</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plume distance: </span><span class="si">{</span><span class="n">plume_dist</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distances between ensembles:
Original intra-ensemble distance : [0.40367679 0.21343417 0.04743079 ... 0.26221506 0.05118074 0.29547632],\ len=1999000
Reproduced intra-ensemble distance: [0.90063806 0.13543413 0.26447127 ... 0.20780622 0.14287555 0.06493068],\ len=12497500
Inter-ensemble distance: [0.31020584 0.59043221 0.17531498 ... 0.22892024 0.43669859 0.37176791]
Plume distance: 0.14388837320933334
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create figure and plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot KDE for individual ensembles with explicit labels</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">orig_intra</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">common_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original LMRv2.1&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">repro_intra</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">common_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reproduced LMRv2.1&#39;</span><span class="p">)</span>

<span class="c1"># Add inter-ensemble distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">inter_dist</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">common_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span> 
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;inter-ensemble&#39;</span><span class="p">)</span>

<span class="c1"># Add plume distance line</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">plume_dist</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;plume distance&#39;</span><span class="p">)</span>

<span class="c1"># Add labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distance Distributions&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4dea7d32429fae2d3bb88cf755fbf43d9859ca3c591d0cd9b811c832a2f4771d.png" src="../../_images/4dea7d32429fae2d3bb88cf755fbf43d9859ca3c591d0cd9b811c832a2f4771d.png" />
</div>
</div>
<p>The distance between my reproduced LMRv2.1 and the original falls within the spread of intra-ensemble variability, and tracks almost exactly with the original distribution, which shows that the reconstructions are very similar and within expected error of each other.</p>
</section>
<section id="validating-gmst-against-instrumental-datasets">
<h2>Validating GMST Against Instrumental Datasets<a class="headerlink" href="#validating-gmst-against-instrumental-datasets" title="Link to this heading">#</a></h2>
<p>Firstly we will validate our reconstructionâ€™s GMST against the original LMRv2.1 (offline) and some instrumental datasets (HadCRUT4, BEST, GISTEMP). Since data was not available for all instrumental datasets, we are using whichever ones we can find an exact match for, all of which came from the <a class="reference external" href="http://www.atmos.uw.edu/~wperkins/nobackup/lmr_data/LMR_data.tar.gz">initial data folder</a>. <br />
<br />
<em>cfr</em>â€™s <code class="docutils literal notranslate"><span class="pre">EnsTS.compare()</span></code> will take the ensemble time series and the plot the median and the spread of our original dataset and plot it against the target, or validation, dataset.</p>
<blockquote>
<div><p>Note: Validation is restricted to 1880â€“2000, the common period across reconstructions and observational datasets.</p>
</div></blockquote>
<section id="validate-against-giss-surface-temperature-analysis-gistemp">
<h3>Validate against GISS Surface Temperature Analysis (GISTEMP)<a class="headerlink" href="#validate-against-giss-surface-temperature-analysis-gistemp" title="Link to this heading">#</a></h3>
<p>The first dataset we will use to validate is <a class="reference external" href="https://data.giss.nasa.gov/gistemp/news/2010summer/">GISTEMP</a>. This exact set was used by Tardif et al. (2019) to validate their reconstruction. Additionally we used it for calibration, so we expect the match against our reconstruction to be fairly high.</p>
<p>First we load load dataset using xarray, then convert to a <em>cfr</em> <code class="docutils literal notranslate"><span class="pre">EnsTS</span></code> (Ensemble Time Series) object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gis</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;./analyses/GISTEMP/gistemp1200_ERSSTv4.nc&#39;</span><span class="p">)</span>
<span class="n">gis</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 660B
Dimensions:      (lat: 5, lon: 5, time: 5, nv: 2)
Coordinates:
  * lat          (lat) float32 20B -89.0 -87.0 -85.0 -83.0 -81.0
  * lon          (lon) float32 20B -179.0 -177.0 -175.0 -173.0 -171.0
  * time         (time) datetime64[ns] 40B 1880-01-15 1880-02-15 ... 1880-05-15
Dimensions without coordinates: nv
Data variables:
    time_bnds    (time, nv) datetime64[ns] 80B 1880-01-01 ... 1880-06-01
    tempanomaly  (time, lat, lon) float32 500B nan nan nan nan ... nan nan nan
Attributes:
    title:        GISTEMP Surface Temperature Analysis
    institution:  NASA Goddard Institute for Space Studies
    source:       http://data.giss.nasa.gov/gistemp/
    Conventions:  CF-1.6
    history:      Created 2017-05-12 10:40:20 by SBBX_to_nc 2.0 - ILAND=1200,...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-26f7c485-ea72-4f7a-aa87-9ef5a1aab1c3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-26f7c485-ea72-4f7a-aa87-9ef5a1aab1c3' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 5</li><li><span class='xr-has-index'>lon</span>: 5</li><li><span class='xr-has-index'>time</span>: 5</li><li><span>nv</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-dd90ab2b-16cc-422a-b81e-6124929263bf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dd90ab2b-16cc-422a-b81e-6124929263bf' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.0 -87.0 -85.0 -83.0 -81.0</div><input id='attrs-44518de0-30fd-4966-aa3f-661eaec2fe26' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-44518de0-30fd-4966-aa3f-661eaec2fe26' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b59ff259-f545-4cea-bbdf-71ea40040aed' class='xr-var-data-in' type='checkbox'><label for='data-b59ff259-f545-4cea-bbdf-71ea40040aed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-89., -87., -85., -83., -81.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-179.0 -177.0 -175.0 -173.0 -171.0</div><input id='attrs-fb7b5d47-75fc-4dfd-b03b-e7c3ae2f2a47' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb7b5d47-75fc-4dfd-b03b-e7c3ae2f2a47' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc2889b2-3b16-4d65-ad95-87f084568204' class='xr-var-data-in' type='checkbox'><label for='data-bc2889b2-3b16-4d65-ad95-87f084568204' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-179., -177., -175., -173., -171.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1880-01-15 ... 1880-05-15</div><input id='attrs-611b0ff7-ab0b-45a0-b289-924dbc4059c5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-611b0ff7-ab0b-45a0-b289-924dbc4059c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba15095b-af0a-4cef-89c3-bd01a0feae98' class='xr-var-data-in' type='checkbox'><label for='data-ba15095b-af0a-4cef-89c3-bd01a0feae98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1880-01-15T00:00:00.000000000&#x27;, &#x27;1880-02-15T00:00:00.000000000&#x27;,
       &#x27;1880-03-15T00:00:00.000000000&#x27;, &#x27;1880-04-15T00:00:00.000000000&#x27;,
       &#x27;1880-05-15T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b5ebcbea-8443-4400-982d-9b24453ed391' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b5ebcbea-8443-4400-982d-9b24453ed391' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, nv)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1880-01-01 ... 1880-06-01</div><input id='attrs-7d6001aa-e177-4239-9262-82cda31adbc6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d6001aa-e177-4239-9262-82cda31adbc6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6edec0f-4eb4-4963-bc15-9cce3d4aa6d6' class='xr-var-data-in' type='checkbox'><label for='data-c6edec0f-4eb4-4963-bc15-9cce3d4aa6d6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[&#x27;1880-01-01T00:00:00.000000000&#x27;, &#x27;1880-02-01T00:00:00.000000000&#x27;],
       [&#x27;1880-02-01T00:00:00.000000000&#x27;, &#x27;1880-03-01T00:00:00.000000000&#x27;],
       [&#x27;1880-03-01T00:00:00.000000000&#x27;, &#x27;1880-04-01T00:00:00.000000000&#x27;],
       [&#x27;1880-04-01T00:00:00.000000000&#x27;, &#x27;1880-05-01T00:00:00.000000000&#x27;],
       [&#x27;1880-05-01T00:00:00.000000000&#x27;, &#x27;1880-06-01T00:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tempanomaly</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-6f5b93a2-7a89-479d-9ef8-2f3043fc352f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6f5b93a2-7a89-479d-9ef8-2f3043fc352f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80cb4b3b-e0d7-4f5a-8dd1-97afa49eb41f' class='xr-var-data-in' type='checkbox'><label for='data-80cb4b3b-e0d7-4f5a-8dd1-97afa49eb41f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Surface temperature anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan]],

       [[nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan]],

       [[nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan]],

       [[nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan]],

       [[nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-51bac80c-7da2-4884-9a31-1f121239edc8' class='xr-section-summary-in' type='checkbox'  ><label for='section-51bac80c-7da2-4884-9a31-1f121239edc8' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-77a28dd0-070e-4e87-9228-f5d6e882a2a6' class='xr-index-data-in' type='checkbox'/><label for='index-77a28dd0-070e-4e87-9228-f5d6e882a2a6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.0, -87.0, -85.0, -83.0, -81.0], dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-17b28edc-d6bb-4834-9421-1c239d93d8c9' class='xr-index-data-in' type='checkbox'/><label for='index-17b28edc-d6bb-4834-9421-1c239d93d8c9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-179.0, -177.0, -175.0, -173.0, -171.0], dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e3c22cc2-64ff-4aa5-84a6-60cb8bacbaf0' class='xr-index-data-in' type='checkbox'/><label for='index-e3c22cc2-64ff-4aa5-84a6-60cb8bacbaf0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1880-01-15&#x27;, &#x27;1880-02-15&#x27;, &#x27;1880-03-15&#x27;, &#x27;1880-04-15&#x27;,
               &#x27;1880-05-15&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a1b6574c-9354-4f5a-ade1-7d5af3c4b120' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a1b6574c-9354-4f5a-ade1-7d5af3c4b120' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>GISTEMP Surface Temperature Analysis</dd><dt><span>institution :</span></dt><dd>NASA Goddard Institute for Space Studies</dd><dt><span>source :</span></dt><dd>http://data.giss.nasa.gov/gistemp/</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Created 2017-05-12 10:40:20 by SBBX_to_nc 2.0 - ILAND=1200, IOCEAN=NCDC/ER4, Base: 1951-1980</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gm</span> <span class="o">=</span> <span class="n">gis</span><span class="o">.</span><span class="n">tempanomaly</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
<span class="n">gis_annual</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Make sure values are properly shaped ([,:1])</span>
<span class="n">gis_values</span> <span class="o">=</span> <span class="n">gis_annual</span><span class="o">.</span><span class="n">values</span>
<span class="k">if</span> <span class="n">gis_values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">gis_values</span> <span class="o">=</span> <span class="n">gis_values</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> 

<span class="c1"># annualize GISTEMP</span>
<span class="n">gis_ts_annual</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">EnsTS</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="n">gis_annual</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="n">gis_values</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Temperature Anomaly&#39;</span>
<span class="p">)</span>

<span class="c1"># Compare LMR with annual data</span>
<span class="n">gis_ts_compared</span> <span class="o">=</span> <span class="n">res_ts</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">gis_ts_annual</span><span class="p">,</span> 
    <span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;GISTEMPv4&#39;</span><span class="p">,</span> 
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">gis_ts_compared</span><span class="o">.</span><span class="n">plot_qs</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">1880</span><span class="p">,</span><span class="mi">2000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/efd9c4a3bbf1fc24d6b77b82010fa6413d531c28018f7753d8b787561c32ac84.png" src="../../_images/efd9c4a3bbf1fc24d6b77b82010fa6413d531c28018f7753d8b787561c32ac84.png" />
</div>
</div>
<p>This comparison evaluates my LMRv2.1 reproduction against GISTEMP, using GISTEMP as the reference. Since the Coefficient of Efficiency (CE) is not symmetric, this direction matters. The result reflects how well the reconstruction explains variance compared to the instrumental record.</p>
<p>The reconstruction shows a strong match with GISTEMPv4, with r = 0.91 and CE = 0.80. Since GISTEMPv4 was the actual temperature calibration set used in LMRv2.1, this agreement between the two is expected. This shows that the reconstruction captures both the trend and variability present in the instrumental temperature recordand it stays well within the ensemble spread for most of the period, which suggests that the emulation is sucessful.</p>
</section>
<section id="validate-against-hadcrut5">
<h3>Validate against HadCRUT5<a class="headerlink" href="#validate-against-hadcrut5" title="Link to this heading">#</a></h3>
<p>Same process as before, but this time we use <a class="reference external" href="https://www.metoffice.gov.uk/hadobs/hadcrut5/">HadCRUT5</a>. This time we load the dataset from the cloud, then convert the dataframe to a <em>cfr</em> <code class="docutils literal notranslate"><span class="pre">EnsTS</span></code> (Ensemble Time Series) object</p>
<blockquote>
<div><p>Note: Tardif et al. (2019) used HadCRUT4 to validate, but since we are running this experiment six years later, it is best to use more up-to-date data.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.metoffice.gov.uk/hadobs/hadcrut5/data/HadCRUT.5.0.2.0/analysis/diagnostics/HadCRUT.5.0.2.0.analysis.summary_series.global.annual.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Anomaly (deg C)</th>
      <th>Lower confidence limit (2.5%)</th>
      <th>Upper confidence limit (97.5%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1850</td>
      <td>-0.417711</td>
      <td>-0.589256</td>
      <td>-0.246166</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1851</td>
      <td>-0.233350</td>
      <td>-0.411868</td>
      <td>-0.054832</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1852</td>
      <td>-0.229399</td>
      <td>-0.409382</td>
      <td>-0.049416</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1853</td>
      <td>-0.270354</td>
      <td>-0.430009</td>
      <td>-0.110700</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1854</td>
      <td>-0.291521</td>
      <td>-0.432712</td>
      <td>-0.150330</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">had_ts_annual</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">EnsTS</span><span class="p">()</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">time_column</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">value_columns</span><span class="o">=</span><span class="s1">&#39;Anomaly (deg C)&#39;</span><span class="p">)</span>
<span class="n">had_ts_compared</span> <span class="o">=</span> <span class="n">res_ts</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">had_ts_annual</span><span class="p">,</span> 
    <span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;HadCRUT5&#39;</span><span class="p">,</span> 
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">had_ts_compared</span><span class="o">.</span><span class="n">plot_qs</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">1850</span><span class="p">,</span><span class="mi">2000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a6a0982ce83aa47bf54024f9f762f92bed217dea60c051976a6b52179a852b84.png" src="../../_images/a6a0982ce83aa47bf54024f9f762f92bed217dea60c051976a6b52179a852b84.png" />
</div>
</div>
<p>The reconstruction shows a strong match with HadCRUT5, with a correlation of r=0.91 and CE = 0.64. This is a strong match, especially considering that HadCRUT5 was not used in the calibration (GISTEMPv4 was used for temperature). The reconstruction still aligns well with an independent dataset and shows that the reproduction closely emulates LMRv2.1 as well as the instrumental record.</p>
</section>
<section id="validate-against-berkeley-earth-surface-temperature-best">
<h3>Validate against Berkeley Earth Surface Temperature (BEST)<a class="headerlink" href="#validate-against-berkeley-earth-surface-temperature-best" title="Link to this heading">#</a></h3>
<p>Same process as before, but for <a class="reference external" href="https://berkeleyearth.org/data/">BEST</a>. First we use <code class="docutils literal notranslate"><span class="pre">load_dataset</span></code> using xarray, then convert to a <em>cfr</em> <code class="docutils literal notranslate"><span class="pre">EnsTS</span></code> (Ensemble Time Series) object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;./analyses/BerkeleyEarth/Land_and_Ocean_LatLong1.nc&#39;</span><span class="p">)</span>
<span class="n">best</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 517MB
Dimensions:      (longitude: 360, latitude: 180, time: 1980, month_number: 12)
Coordinates:
  * longitude    (longitude) float32 1kB -179.5 -178.5 -177.5 ... 178.5 179.5
  * latitude     (latitude) float32 720B -89.5 -88.5 -87.5 ... 87.5 88.5 89.5
  * time         (time) float64 16kB 1.85e+03 1.85e+03 ... 2.015e+03 2.015e+03
Dimensions without coordinates: month_number
Data variables:
    land_mask    (latitude, longitude) float64 518kB 1.0 1.0 1.0 ... 0.0 0.0 0.0
    temperature  (time, latitude, longitude) float32 513MB nan nan ... 0.4641
    climatology  (month_number, latitude, longitude) float32 3MB -28.21 ... -...
Attributes:
    Conventions:           Berkeley Earth Internal Convention (based on CF-1.5)
    title:                 Native Format Berkeley Earth Surface Temperature A...
    history:               17-Feb-2015 11:17:51
    institution:           Berkeley Earth Surface Temperature Project
    land_source_history:   16-Jan-2015 09:30:27
    ocean_source_history:  08-Jan-2015 06:07:03
    comment:               This file contains Berkeley Earth surface temperat...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-49a9f34e-8d0c-4933-afdc-a1951e2d8238' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-49a9f34e-8d0c-4933-afdc-a1951e2d8238' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>longitude</span>: 360</li><li><span class='xr-has-index'>latitude</span>: 180</li><li><span class='xr-has-index'>time</span>: 1980</li><li><span>month_number</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-a9274153-a501-4295-b84b-93c1804d9121' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a9274153-a501-4295-b84b-93c1804d9121' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-179.5 -178.5 ... 178.5 179.5</div><input id='attrs-0f320420-8db9-4727-9191-39ee921027c9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0f320420-8db9-4727-9191-39ee921027c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-434d078a-5d4a-4c1b-a3f1-ad1eaded5097' class='xr-var-data-in' type='checkbox'><label for='data-434d078a-5d4a-4c1b-a3f1-ad1eaded5097' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd></dl></div><div class='xr-var-data'><pre>array([-179.5, -178.5, -177.5, ...,  177.5,  178.5,  179.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-1e7774f6-55bd-40bb-bbc3-eabb69b81dfe' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1e7774f6-55bd-40bb-bbc3-eabb69b81dfe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee656d4d-f9d4-4357-8b7e-aa0928654fca' class='xr-var-data-in' type='checkbox'><label for='data-ee656d4d-f9d4-4357-8b7e-aa0928654fca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.85e+03 1.85e+03 ... 2.015e+03</div><input id='attrs-a01e74f0-e7e3-4cb5-88ed-2089e79ea510' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a01e74f0-e7e3-4cb5-88ed-2089e79ea510' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb019606-9aef-417a-9f10-65c0f3109002' class='xr-var-data-in' type='checkbox'><label for='data-fb019606-9aef-417a-9f10-65c0f3109002' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>year A.D.</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd></dl></div><div class='xr-var-data'><pre>array([1850.041667, 1850.125   , 1850.208333, ..., 2014.791667, 2014.875   ,
       2014.958333])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-466da349-61bf-4b03-a9c7-69cf4a1f5464' class='xr-section-summary-in' type='checkbox'  checked><label for='section-466da349-61bf-4b03-a9c7-69cf4a1f5464' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>land_mask</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-29e31cb8-6f1d-4d1d-a0b2-4b553009d933' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-29e31cb8-6f1d-4d1d-a0b2-4b553009d933' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbcd0073-d688-428e-a01e-d76a9600847f' class='xr-var-data-in' type='checkbox'><label for='data-cbcd0073-d688-428e-a01e-d76a9600847f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>none</dd><dt><span>standard_name :</span></dt><dd>land_mask</dd><dt><span>long_name :</span></dt><dd>Land Mask</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>1.0</dd></dl></div><div class='xr-var-data'><pre>array([[1., 1., 1., ..., 1., 1., 1.],
       [1., 1., 1., ..., 1., 1., 1.],
       [1., 1., 1., ..., 1., 1., 1.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temperature</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.4631 0.4641</div><input id='attrs-a940bd20-3f37-4b8d-b3ab-b51695924e7e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a940bd20-3f37-4b8d-b3ab-b51695924e7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1673ead5-e01c-4835-8206-c6513a3bc2b5' class='xr-var-data-in' type='checkbox'><label for='data-1673ead5-e01c-4835-8206-c6513a3bc2b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degree C</dd><dt><span>standard_name :</span></dt><dd>surface_temperature_anomaly</dd><dt><span>long_name :</span></dt><dd>Air Surface Temperature Anomaly</dd><dt><span>valid_min :</span></dt><dd>-17.481789826249717</dd><dt><span>valid_max :</span></dt><dd>23.132011428109774</dd></dl></div><div class='xr-var-data'><pre>array([[[        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        ...,
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan]],

       [[        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
...
        [ 2.3392344 ,  2.3416731 ,  2.3426774 , ...,  2.3287082 ,
          2.331802  ,  2.3359811 ],
        [ 1.8885922 ,  1.8951684 ,  1.90155   , ...,  1.8655236 ,
          1.8740989 ,  1.8817985 ],
        [ 1.7705178 ,  1.7710365 ,  1.7715057 , ...,  1.7686385 ,
          1.7693107 ,  1.7699403 ]],

       [[ 0.03963067,  0.03888644,  0.03817474, ...,  0.0420571 ,
          0.04121615,  0.04040729],
        [-0.17415276, -0.17579378, -0.17733753, ..., -0.16864356,
         -0.17057788, -0.17241421],
        [-0.40269837, -0.4047508 , -0.40659848, ..., -0.39531836,
         -0.3979814 , -0.40044168],
        ...,
        [ 0.13773227,  0.13802898,  0.13384563, ...,  0.1468012 ,
          0.13957372,  0.13777146],
        [ 0.3981431 ,  0.40760106,  0.4171141 , ...,  0.36884215,
          0.3789063 ,  0.38869226],
        [ 0.4651999 ,  0.46628734,  0.46740958, ...,  0.46205625,
          0.46308073,  0.46413353]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>climatology</span></div><div class='xr-var-dims'>(month_number, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-28.21 -28.19 ... -31.3 -31.3</div><input id='attrs-45b2a1ba-660e-4299-83b2-ca721ba1f34f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-45b2a1ba-660e-4299-83b2-ca721ba1f34f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-39c9375c-39b2-4311-ac06-c7233b155760' class='xr-var-data-in' type='checkbox'><label for='data-39c9375c-39b2-4311-ac06-c7233b155760' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degree C</dd><dt><span>standard_name :</span></dt><dd>surface_temperature_climatology</dd><dt><span>long_name :</span></dt><dd>Air Surface Temperature Climatology (Jan 1951 - Dec 1980)</dd><dt><span>valid_min :</span></dt><dd>-67.54999096980748</dd><dt><span>valid_max :</span></dt><dd>38.80830696784267</dd></dl></div><div class='xr-var-data'><pre>array([[[-28.209646, -28.185844, -28.174889, ..., -28.23251 ,
         -28.22613 , -28.221445],
        [-30.286318, -30.316586, -30.36317 , ..., -30.223343,
         -30.248571, -30.267176],
        [-29.452799, -29.475773, -29.459503, ..., -29.466125,
         -29.473219, -29.453037],
        ...,
        [-33.14278 , -33.145897, -33.143448, ..., -33.144524,
         -33.145004, -33.141735],
        [-33.121456, -33.125107, -33.126717, ..., -33.128742,
         -33.126274, -33.121815],
        [-32.89023 , -32.893185, -32.8953  , ..., -32.894386,
         -32.892643, -32.89005 ]],

       [[-39.710506, -39.688927, -39.669518, ..., -39.776382,
         -39.75364 , -39.73247 ],
        [-40.93353 , -40.929295, -40.92758 , ..., -40.96677 ,
         -40.952946, -40.941998],
        [-39.301563, -39.248436, -39.15887 , ..., -39.41471 ,
         -39.384766, -39.344532],
...
        [-27.184605, -27.178143, -27.169827, ..., -27.211687,
         -27.201843, -27.192568],
        [-27.360273, -27.360073, -27.358185, ..., -27.373487,
         -27.369814, -27.36375 ],
        [-27.443104, -27.444664, -27.445543, ..., -27.44913 ,
         -27.446812, -27.443819]],

       [[-26.484667, -26.470825, -26.467033, ..., -26.533966,
         -26.51201 , -26.498785],
        [-28.621096, -28.65584 , -28.706444, ..., -28.627426,
         -28.609625, -28.60677 ],
        [-27.791721, -27.819614, -27.806576, ..., -27.87309 ,
         -27.842934, -27.79772 ],
        ...,
        [-31.610525, -31.60416 , -31.592031, ..., -31.648186,
         -31.63588 , -31.620626],
        [-31.556198, -31.555943, -31.55281 , ..., -31.580727,
         -31.572956, -31.561981],
        [-31.294294, -31.296576, -31.2977  , ..., -31.305628,
         -31.301338, -31.295885]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a4878b51-0653-4a51-95e6-477bced6c626' class='xr-section-summary-in' type='checkbox'  ><label for='section-a4878b51-0653-4a51-95e6-477bced6c626' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9c892aad-614a-4d74-abf7-32bcb3b3bcd1' class='xr-index-data-in' type='checkbox'/><label for='index-9c892aad-614a-4d74-abf7-32bcb3b3bcd1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-179.5, -178.5, -177.5, -176.5, -175.5, -174.5, -173.5, -172.5, -171.5,
       -170.5,
       ...
        170.5,  171.5,  172.5,  173.5,  174.5,  175.5,  176.5,  177.5,  178.5,
        179.5],
      dtype=&#x27;float32&#x27;, name=&#x27;longitude&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-12e30df8-cc21-4296-aa1a-b41570d49746' class='xr-index-data-in' type='checkbox'/><label for='index-12e30df8-cc21-4296-aa1a-b41570d49746' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       ...
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;latitude&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-eacd3f2b-f053-4b0f-bc25-5896aa1c6bc4' class='xr-index-data-in' type='checkbox'/><label for='index-eacd3f2b-f053-4b0f-bc25-5896aa1c6bc4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1850.0416666666667,           1850.125, 1850.2083333333333,
       1850.2916666666667,           1850.375, 1850.4583333333333,
       1850.5416666666667,           1850.625, 1850.7083333333333,
       1850.7916666666667,
       ...
       2014.2083333333333, 2014.2916666666665,           2014.375,
       2014.4583333333333, 2014.5416666666665,           2014.625,
       2014.7083333333333, 2014.7916666666665,           2014.875,
       2014.9583333333333],
      dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=1980))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-32c919c2-bb8a-4511-b988-33414b0f3f4f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-32c919c2-bb8a-4511-b988-33414b0f3f4f' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>Berkeley Earth Internal Convention (based on CF-1.5)</dd><dt><span>title :</span></dt><dd>Native Format Berkeley Earth Surface Temperature Anomaly Field</dd><dt><span>history :</span></dt><dd>17-Feb-2015 11:17:51</dd><dt><span>institution :</span></dt><dd>Berkeley Earth Surface Temperature Project</dd><dt><span>land_source_history :</span></dt><dd>16-Jan-2015 09:30:27</dd><dt><span>ocean_source_history :</span></dt><dd>08-Jan-2015 06:07:03</dd><dt><span>comment :</span></dt><dd>This file contains Berkeley Earth surface temperature anomaly field in our native equal-area format.</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gm</span> <span class="o">=</span> <span class="n">best</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>

<span class="c1"># Convert time coordinate to datetime index (specific to BEST)</span>
<span class="n">time_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;1850-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">best</span><span class="o">.</span><span class="n">time</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">gm</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_index</span><span class="p">)</span>

<span class="n">best_annual</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Reshape values if needed</span>
<span class="n">best_values</span> <span class="o">=</span> <span class="n">best_annual</span><span class="o">.</span><span class="n">values</span>
<span class="k">if</span> <span class="n">best_values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">best_values</span> <span class="o">=</span> <span class="n">best_values</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

<span class="c1"># annualize</span>
<span class="n">best_ts_annual</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">EnsTS</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="n">best_annual</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="n">best_values</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Temperature Anomaly&#39;</span>
<span class="p">)</span>

<span class="c1"># Compare LMR with annual data</span>
<span class="n">best_ts_compared</span> <span class="o">=</span> <span class="n">res_ts</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">best_ts_annual</span><span class="p">,</span>
    <span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;BEST&#39;</span><span class="p">,</span>
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">best_ts_compared</span><span class="o">.</span><span class="n">plot_qs</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/75b0dcb7a05297d8aff1db091dad0737a7a9bf936c791bdb26d37755b7617896.png" src="../../_images/75b0dcb7a05297d8aff1db091dad0737a7a9bf936c791bdb26d37755b7617896.png" />
</div>
</div>
<p>Similarly to HADCRUT5, the reconstruction shows a strong match with BEST, with a correlation of r=0.88 and CE = 0.69. This is still a strong match, since BEST was also not used in the calibration. The reconstruction still aligns well with an independent dataset and shows that the reproduction closely emulates LMRv2.1 as well as the instrumental record.</p>
</section>
<section id="plot-consensus">
<h3>Plot Consensus<a class="headerlink" href="#plot-consensus" title="Link to this heading">#</a></h3>
<p>In addition to the individual validation analyses, we can now plot them all together along with a â€˜consensusâ€™ time series, which is the mean of all the instrumental datasets.</p>
<blockquote>
<div><p>We create a consensus validation target by averaging HadCRUT5, GISTEMP, and BEST time series.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># combine all datasets to calculate mean</span>
<span class="n">all_refs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
   <span class="n">had_ts_compared</span><span class="o">.</span><span class="n">ref_value</span><span class="p">[:</span><span class="mi">121</span><span class="p">],</span>
   <span class="n">gis_ts_compared</span><span class="o">.</span><span class="n">ref_value</span><span class="p">[:</span><span class="mi">121</span><span class="p">],</span>
   <span class="n">best_ts_compared</span><span class="o">.</span><span class="n">ref_value</span><span class="p">[:</span><span class="mi">121</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">mean_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_refs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">mean_ts_annual</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">EnsTS</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="n">best_annual</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="o">-</span><span class="mi">14</span><span class="p">],</span> <span class="c1">#manually slice dates</span>
    <span class="n">value</span><span class="o">=</span><span class="n">mean_ref</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Temperature Anomaly&#39;</span>
<span class="p">)</span>

<span class="n">mean_ts_compared</span> <span class="o">=</span> <span class="n">res_ts</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">mean_ts_annual</span><span class="p">,</span>
    <span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;Consensus&#39;</span><span class="p">,</span>
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mean_ts_compared</span><span class="o">.</span><span class="n">plot_qs</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6ed5b3e696bbd2d6ff8e4ec0e8df24a0489aab08cc42294d38fe65676136fb65.png" src="../../_images/6ed5b3e696bbd2d6ff8e4ec0e8df24a0489aab08cc42294d38fe65676136fb65.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create base plot without validation plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">had_ts_compared</span><span class="o">.</span><span class="n">plot_qs</span><span class="p">(</span>
   <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> 
   <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;indianred&#39;</span><span class="p">,</span>
   <span class="n">plot_valid</span><span class="o">=</span><span class="kc">False</span> 
<span class="p">)</span>

<span class="k">for</span> <span class="n">compared</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[</span>
   <span class="p">(</span><span class="n">had_ts_compared</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;HadCRUT5&#39;</span><span class="p">),</span>
   <span class="p">(</span><span class="n">gis_ts_compared</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;GISTEMP&#39;</span><span class="p">),</span>
   <span class="p">(</span><span class="n">best_ts_compared</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;Berkeley Earth&#39;</span><span class="p">),</span>
   <span class="p">(</span><span class="n">mean_ts_compared</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;Consensus&#39;</span><span class="p">)</span>
   
<span class="p">]:</span>
   <span class="n">stats</span> <span class="o">=</span> <span class="n">compared</span><span class="o">.</span><span class="n">valid_stats</span>
   <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> (r=</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;corr&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, CE=</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;CE&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span>
   <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">compared</span><span class="o">.</span><span class="n">ref_time</span><span class="p">,</span> <span class="n">compared</span><span class="o">.</span><span class="n">ref_value</span><span class="p">[:</span><span class="mi">121</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CFR Reproduced vs Observational Data 1880-2000&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;CFR Reproduced vs Observational Data 1880-2000&#39;)
</pre></div>
</div>
<img alt="../../_images/e59d7bb6b79922d6a6afde02ecd05f82567d8f11bc336f0aa6ec4719a80f529b.png" src="../../_images/e59d7bb6b79922d6a6afde02ecd05f82567d8f11bc336f0aa6ec4719a80f529b.png" />
</div>
</div>
<p>The reconstruction aligns closely with the instrumental consensus series, with r=0.92 and CE=0.73. This consensus represents an average across multiple observational datasets, so strong agreement here reinforces that the reconstruction captures the core features of the instrumental record. The fact that all targets (HadCRUT5, GISTEMPv4, BEST, and the consensus) fall within the ensemble spread shows the robustness of the reproduced reconstruction.</p>
</section>
</section>
<section id="validate-climate-field">
<h2>Validate Climate Field<a class="headerlink" href="#validate-climate-field" title="Link to this heading">#</a></h2>
<section id="load-field-reconstruction">
<h3>Load field reconstruction<a class="headerlink" href="#load-field-reconstruction" title="Link to this heading">#</a></h3>
<p>Load in the original LMR <code class="docutils literal notranslate"><span class="pre">air</span></code> (2m air temperature) climate field as a <em>cfr</em> <code class="docutils literal notranslate"><span class="pre">ClimateField</span></code> object and modify the format so that we can more easily compare it with our validation datasets using <em>cfr</em>. In this step, we will plot both the correlation (corr) and the coefficient of efficiency (CE) of 2m air temperature against the Berkeley Earth Surface Temperature (BEST) climate field, since that was what Tardif et al. (2019) used to validate their field reconstructions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cfr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Load the data as a ClimateField object</span>
<span class="n">lmr_tas</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ClimateField</span><span class="p">()</span><span class="o">.</span><span class="n">load_nc</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./prev_data/air_MCruns_ensemble_mean_LMRv2.1.nc&#39;</span><span class="p">,</span>
    <span class="n">vn</span><span class="o">=</span><span class="s1">&#39;air&#39;</span><span class="p">,</span> 
    <span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>  
    <span class="n">lat_name</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> 
    <span class="n">lon_name</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span>
<span class="p">)</span>

<span class="c1"># Take the mean across the MCrun dimension</span>
<span class="k">if</span> <span class="s1">&#39;MCrun&#39;</span> <span class="ow">in</span> <span class="n">lmr_tas</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
    <span class="n">lmr_tas</span><span class="o">.</span><span class="n">da</span> <span class="o">=</span> <span class="n">lmr_tas</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;MCrun&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the time mean across the entire dataset</span>
<span class="n">lmr_tas_mean</span> <span class="o">=</span> <span class="n">lmr_tas</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="c1"># Create a new ClimateField with this time-mean data</span>
<span class="n">mean_field</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ClimateField</span><span class="p">()</span>
<span class="n">mean_field</span><span class="o">.</span><span class="n">da</span> <span class="o">=</span> <span class="n">lmr_tas_mean</span>
<span class="c1"># Add a name to the DataArray </span>
<span class="n">mean_field</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span>

<span class="c1"># Explicitly provide a title </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mean_field</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;LMR 2m Air Temperature - Full Period Mean&quot;</span><span class="p">)</span>

<span class="c1"># Manually adjust the colormap and limits if needed</span>
<span class="n">imgs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_images</span><span class="p">()</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">imgs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">im</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
    <span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># adjust based on your data range</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Temperature Anomaly (Â°C)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bd072acafb61c09e490300d9b19ebf6131ba1cd9bf25afff2590356daaad63c6.png" src="../../_images/bd072acafb61c09e490300d9b19ebf6131ba1cd9bf25afff2590356daaad63c6.png" />
</div>
</div>
</section>
<section id="loading-reproduced">
<h3>Loading reproduced<a class="headerlink" href="#loading-reproduced" title="Link to this heading">#</a></h3>
<p>Opening one reconstruction file to check its formatting. Then plot the results of the full <code class="docutils literal notranslate"><span class="pre">'tas'</span></code> reconstruction to make sure it works and looks the way it should.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./recons/lmr_reproduce_pda_ptype_res/job_r01_recon.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 96MB
Dimensions:  (time: 2000, ens: 100, lat: 42, lon: 63)
Coordinates:
  * time     (time) int64 16kB 1 2 3 4 5 6 7 ... 1995 1996 1997 1998 1999 2000
  * ens      (ens) int64 800B 0 1 2 3 4 5 6 7 8 9 ... 91 92 93 94 95 96 97 98 99
  * lat      (lat) float64 336B -90.0 -85.61 -81.22 -76.83 ... 81.22 85.61 90.0
  * lon      (lon) float64 504B 0.0 5.806 11.61 17.42 ... 348.4 354.2 360.0
Data variables:
    tas_gm   (time, ens) float64 2MB ...
    tas_nhm  (time, ens) float64 2MB ...
    tas_shm  (time, ens) float64 2MB ...
    nino3.4  (time, ens) float64 2MB ...
    tas      (time, lat, lon) float64 42MB ...
    pr_gm    (time, ens) float64 2MB ...
    pr_nhm   (time, ens) float64 2MB ...
    pr_shm   (time, ens) float64 2MB ...
    pr       (time, lat, lon) float64 42MB ...
Attributes:
    pids_assim:  [&#x27;NAm_153&#x27;, &#x27;Asi_178&#x27;, &#x27;Asi_174&#x27;, &#x27;Asi_198&#x27;, &#x27;Arc_071&#x27;, &#x27;NAm...
    pids_eval:   [&#x27;NAm_165&#x27;, &#x27;NAm_145&#x27;, &#x27;NAm_193&#x27;, &#x27;Asi_098&#x27;, &#x27;NAm_086&#x27;, &#x27;Asi...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-16f7322d-ebe8-449a-a792-ed17a77c646a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-16f7322d-ebe8-449a-a792-ed17a77c646a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2000</li><li><span class='xr-has-index'>ens</span>: 100</li><li><span class='xr-has-index'>lat</span>: 42</li><li><span class='xr-has-index'>lon</span>: 63</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-74ab4ed9-b1f1-411c-ad49-cc6d2a0b46cc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-74ab4ed9-b1f1-411c-ad49-cc6d2a0b46cc' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 ... 1997 1998 1999 2000</div><input id='attrs-e3926d24-a192-4aba-8c79-b28ad870efe6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e3926d24-a192-4aba-8c79-b28ad870efe6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4bdaf48-6eb4-46bb-84a5-98aa2b67be8a' class='xr-var-data-in' type='checkbox'><label for='data-b4bdaf48-6eb4-46bb-84a5-98aa2b67be8a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   1,    2,    3, ..., 1998, 1999, 2000])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>ens</span></div><div class='xr-var-dims'>(ens)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 94 95 96 97 98 99</div><input id='attrs-4e02a8da-2db8-4ef4-b1c1-a8512e67cea9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4e02a8da-2db8-4ef4-b1c1-a8512e67cea9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8f5fdbf-a961-4aab-8c57-60171a3ef570' class='xr-var-data-in' type='checkbox'><label for='data-d8f5fdbf-a961-4aab-8c57-60171a3ef570' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -85.61 -81.22 ... 85.61 90.0</div><input id='attrs-eed9c577-84dc-4438-9f80-c7092cf95fea' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eed9c577-84dc-4438-9f80-c7092cf95fea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-466bb5aa-5fb5-496c-bdde-c06bbafa680a' class='xr-var-data-in' type='checkbox'><label for='data-466bb5aa-5fb5-496c-bdde-c06bbafa680a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-90.      , -85.609756, -81.219512, -76.829268, -72.439024, -68.04878 ,
       -63.658537, -59.268293, -54.878049, -50.487805, -46.097561, -41.707317,
       -37.317073, -32.926829, -28.536585, -24.146341, -19.756098, -15.365854,
       -10.97561 ,  -6.585366,  -2.195122,   2.195122,   6.585366,  10.97561 ,
        15.365854,  19.756098,  24.146341,  28.536585,  32.926829,  37.317073,
        41.707317,  46.097561,  50.487805,  54.878049,  59.268293,  63.658537,
        68.04878 ,  72.439024,  76.829268,  81.219512,  85.609756,  90.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 5.806 11.61 ... 354.2 360.0</div><input id='attrs-20c19a62-f5e9-45d3-b458-b8ab0f2eded0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-20c19a62-f5e9-45d3-b458-b8ab0f2eded0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c787b79-5343-44a6-a51b-b856a9cf9b55' class='xr-var-data-in' type='checkbox'><label for='data-9c787b79-5343-44a6-a51b-b856a9cf9b55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0.      ,   5.806452,  11.612903,  17.419355,  23.225806,  29.032258,
        34.83871 ,  40.645161,  46.451613,  52.258065,  58.064516,  63.870968,
        69.677419,  75.483871,  81.290323,  87.096774,  92.903226,  98.709677,
       104.516129, 110.322581, 116.129032, 121.935484, 127.741935, 133.548387,
       139.354839, 145.16129 , 150.967742, 156.774194, 162.580645, 168.387097,
       174.193548, 180.      , 185.806452, 191.612903, 197.419355, 203.225806,
       209.032258, 214.83871 , 220.645161, 226.451613, 232.258065, 238.064516,
       243.870968, 249.677419, 255.483871, 261.290323, 267.096774, 272.903226,
       278.709677, 284.516129, 290.322581, 296.129032, 301.935484, 307.741935,
       313.548387, 319.354839, 325.16129 , 330.967742, 336.774194, 342.580645,
       348.387097, 354.193548, 360.      ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0f2472a6-75b3-4e91-a9db-a12430c32fa1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0f2472a6-75b3-4e91-a9db-a12430c32fa1' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas_gm</span></div><div class='xr-var-dims'>(time, ens)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-fd3efc70-6f3a-4fe9-a3a1-7614a8e10309' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fd3efc70-6f3a-4fe9-a3a1-7614a8e10309' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ddde5137-aa01-4509-abcd-b0ef02d44bad' class='xr-var-data-in' type='checkbox'><label for='data-ddde5137-aa01-4509-abcd-b0ef02d44bad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[200000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas_nhm</span></div><div class='xr-var-dims'>(time, ens)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-aa5a1931-47c5-498b-94d1-2506c85e3f59' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aa5a1931-47c5-498b-94d1-2506c85e3f59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a418dcb-32b0-4f52-8dc2-24d4fdf9e8e8' class='xr-var-data-in' type='checkbox'><label for='data-6a418dcb-32b0-4f52-8dc2-24d4fdf9e8e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[200000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas_shm</span></div><div class='xr-var-dims'>(time, ens)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1c883060-a7fd-415f-b5f0-54818ea5a95f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1c883060-a7fd-415f-b5f0-54818ea5a95f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2f5824b7-7dc4-4e62-a230-056485ea9deb' class='xr-var-data-in' type='checkbox'><label for='data-2f5824b7-7dc4-4e62-a230-056485ea9deb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[200000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nino3.4</span></div><div class='xr-var-dims'>(time, ens)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-95b5ce55-edc8-4099-97fe-c8c91e4a7c27' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-95b5ce55-edc8-4099-97fe-c8c91e4a7c27' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0ff67a45-a91a-460f-b300-21c0879dca8c' class='xr-var-data-in' type='checkbox'><label for='data-0ff67a45-a91a-460f-b300-21c0879dca8c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[200000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e5c58a7d-63d2-4e89-9844-d9e222f4e397' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e5c58a7d-63d2-4e89-9844-d9e222f4e397' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1023624e-2f3f-49cd-a1b2-bb8b17bb1d52' class='xr-var-data-in' type='checkbox'><label for='data-1023624e-2f3f-49cd-a1b2-bb8b17bb1d52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[5292000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pr_gm</span></div><div class='xr-var-dims'>(time, ens)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-11348d2a-66b4-48f2-98f1-ec20680b9019' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-11348d2a-66b4-48f2-98f1-ec20680b9019' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-82865d09-1fec-448b-888d-50e67de99395' class='xr-var-data-in' type='checkbox'><label for='data-82865d09-1fec-448b-888d-50e67de99395' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[200000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pr_nhm</span></div><div class='xr-var-dims'>(time, ens)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4b59398a-2a06-4e41-b5eb-aeda19055c61' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4b59398a-2a06-4e41-b5eb-aeda19055c61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86d6433f-a2ed-49d4-9258-400e75d99a2b' class='xr-var-data-in' type='checkbox'><label for='data-86d6433f-a2ed-49d4-9258-400e75d99a2b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[200000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pr_shm</span></div><div class='xr-var-dims'>(time, ens)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6101ccdc-ab4a-4aee-99fc-663654cfdd64' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6101ccdc-ab4a-4aee-99fc-663654cfdd64' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-060c1581-2c03-409c-aaeb-49ed7127bc14' class='xr-var-data-in' type='checkbox'><label for='data-060c1581-2c03-409c-aaeb-49ed7127bc14' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[200000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bcd70c9a-b3ed-4a27-9d93-02889cfeeb03' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bcd70c9a-b3ed-4a27-9d93-02889cfeeb03' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dad645f4-4316-4dd5-9d28-c30c1c839322' class='xr-var-data-in' type='checkbox'><label for='data-dad645f4-4316-4dd5-9d28-c30c1c839322' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[5292000 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-22a5594a-9577-4c99-95b6-aa7fc1f20830' class='xr-section-summary-in' type='checkbox'  ><label for='section-22a5594a-9577-4c99-95b6-aa7fc1f20830' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7c698dd5-c7c8-4580-8f1d-96dfc3a146aa' class='xr-index-data-in' type='checkbox'/><label for='index-7c698dd5-c7c8-4580-8f1d-96dfc3a146aa' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   1,    2,    3,    4,    5,    6,    7,    8,    9,   10,
       ...
       1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000],
      dtype=&#x27;int64&#x27;, name=&#x27;time&#x27;, length=2000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>ens</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a47b845e-0678-42dc-8d98-b93ce488c32c' class='xr-index-data-in' type='checkbox'/><label for='index-a47b845e-0678-42dc-8d98-b93ce488c32c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97, 98, 99],
      dtype=&#x27;int64&#x27;, name=&#x27;ens&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-84de516c-a559-4df5-9f80-deee9409bcd8' class='xr-index-data-in' type='checkbox'/><label for='index-84de516c-a559-4df5-9f80-deee9409bcd8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -90.0,  -85.60975609756098,  -81.21951219512195,
        -76.82926829268293,   -72.4390243902439,  -68.04878048780488,
        -63.65853658536585,  -59.26829268292683,   -54.8780487804878,
        -50.48780487804878,  -46.09756097560975,  -41.70731707317073,
         -37.3170731707317,  -32.92682926829268, -28.536585365853654,
        -24.14634146341463, -19.756097560975604,  -15.36585365853658,
       -10.975609756097555,   -6.58536585365853, -2.1951219512195053,
        2.1951219512195195,   6.585365853658544,  10.975609756097569,
        15.365853658536594,   19.75609756097562,  24.146341463414643,
        28.536585365853668,   32.92682926829269,   37.31707317073172,
         41.70731707317074,   46.09756097560978,   50.48780487804879,
          54.8780487804878,   59.26829268292684,   63.65853658536588,
         68.04878048780489,    72.4390243902439,   76.82926829268294,
         81.21951219512198,   85.60975609756099,                90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ab5f1a51-310c-4eba-ac79-22dd45a501c3' class='xr-index-data-in' type='checkbox'/><label for='index-ab5f1a51-310c-4eba-ac79-22dd45a501c3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([               0.0,  5.806451612903226, 11.612903225806452,
        17.41935483870968, 23.225806451612904, 29.032258064516128,
        34.83870967741936, 40.645161290322584,  46.45161290322581,
        52.25806451612903, 58.064516129032256,  63.87096774193549,
        69.67741935483872,  75.48387096774194,  81.29032258064517,
        87.09677419354838,  92.90322580645162,  98.70967741935485,
       104.51612903225806,  110.3225806451613, 116.12903225806451,
       121.93548387096774, 127.74193548387098,  133.5483870967742,
       139.35483870967744, 145.16129032258064, 150.96774193548387,
        156.7741935483871, 162.58064516129033, 168.38709677419357,
       174.19354838709677,              180.0, 185.80645161290323,
       191.61290322580646,  197.4193548387097,  203.2258064516129,
       209.03225806451613, 214.83870967741936,  220.6451612903226,
       226.45161290322582, 232.25806451612902, 238.06451612903226,
        243.8709677419355, 249.67741935483872, 255.48387096774195,
        261.2903225806452,  267.0967741935484, 272.90322580645164,
        278.7096774193549, 284.51612903225805,  290.3225806451613,
        296.1290322580645, 301.93548387096774,   307.741935483871,
        313.5483870967742, 319.35483870967744, 325.16129032258067,
        330.9677419354839, 336.77419354838713,  342.5806451612903,
       348.38709677419354, 354.19354838709677,              360.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cf3389fd-1bd2-4ea3-bb79-1bc22183a6dc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cf3389fd-1bd2-4ea3-bb79-1bc22183a6dc' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>pids_assim :</span></dt><dd>[&#x27;NAm_153&#x27;, &#x27;Asi_178&#x27;, &#x27;Asi_174&#x27;, &#x27;Asi_198&#x27;, &#x27;Arc_071&#x27;, &#x27;NAm_102&#x27;, &#x27;NAm_046&#x27;, &#x27;Ocn_065&#x27;, &#x27;Asi_170&#x27;, &#x27;Asi_045&#x27;, &#x27;NAm_149&#x27;, &#x27;NAm_194&#x27;, &#x27;NAm_089&#x27;, &#x27;NAm_188&#x27;, &#x27;Asi_184&#x27;, &#x27;Asi_214&#x27;, &#x27;Ocn_075&#x27;, &#x27;Asi_147&#x27;, &#x27;NAm_099&#x27;, &#x27;Asi_070&#x27;, &#x27;Asi_215&#x27;, &#x27;Asi_223&#x27;, &#x27;NAm_156&#x27;, &#x27;Asi_009&#x27;, &#x27;Asi_173&#x27;, &#x27;Asi_047&#x27;, &#x27;Ocn_078&#x27;, &#x27;NAm_154&#x27;, &#x27;Asi_148&#x27;, &#x27;Asi_191&#x27;, &#x27;Asi_062&#x27;, &#x27;Asi_019&#x27;, &#x27;Ocn_167&#x27;, &#x27;NAm_085&#x27;, &#x27;Ocn_091&#x27;, &#x27;Ocn_093&#x27;, &#x27;Asi_155&#x27;, &#x27;Ant_024&#x27;, &#x27;NAm_098&#x27;, &#x27;Asi_073&#x27;, &#x27;Asi_094&#x27;, &#x27;Ocn_096&#x27;, &#x27;Asi_052&#x27;, &#x27;Ocn_086&#x27;, &#x27;Asi_117&#x27;, &#x27;NAm_161&#x27;, &#x27;Asi_030&#x27;, &#x27;Ocn_101&#x27;, &#x27;NAm_066&#x27;, &#x27;Ocn_070&#x27;, &#x27;Asi_084&#x27;, &#x27;NAm_050&#x27;, &#x27;Asi_135&#x27;, &#x27;Asi_144&#x27;, &#x27;Asi_185&#x27;, &#x27;Asi_115&#x27;, &#x27;NAm_133&#x27;, &#x27;NAm_134&#x27;, &#x27;Asi_176&#x27;, &#x27;NAm_093&#x27;, &#x27;Asi_228&#x27;, &#x27;NAm_090&#x27;, &#x27;Asi_202&#x27;, &#x27;NAm_189&#x27;, &#x27;NAm_171&#x27;, &#x27;Asi_203&#x27;, &#x27;Arc_029&#x27;, &#x27;NAm_113&#x27;, &#x27;Asi_020&#x27;, &#x27;Ocn_158&#x27;, &#x27;NAm_157&#x27;, &#x27;NAm_124&#x27;, &#x27;Asi_006&#x27;, &#x27;Asi_033&#x27;, &#x27;Arc_035&#x27;, &#x27;Ant_001&#x27;, &#x27;NAm_049&#x27;, &#x27;NAm_091&#x27;, &#x27;Ocn_080&#x27;, &#x27;Asi_152&#x27;, &#x27;Asi_043&#x27;, &#x27;Asi_028&#x27;, &#x27;Asi_025&#x27;, &#x27;Ocn_103&#x27;, &#x27;Arc_079&#x27;, &#x27;Asi_060&#x27;, &#x27;Asi_007&#x27;, &#x27;Asi_087&#x27;, &#x27;Asi_116&#x27;, &#x27;Eur_004&#x27;, &#x27;Ocn_068&#x27;, &#x27;Asi_075&#x27;, &#x27;Ant_006&#x27;, &#x27;Asi_040&#x27;, &#x27;NAm_183&#x27;, &#x27;Asi_012&#x27;, &#x27;Aus_002&#x27;, &#x27;Asi_078&#x27;, &#x27;NAm_019&#x27;, &#x27;Ant_002&#x27;, &#x27;NAm_103&#x27;, &#x27;Arc_080&#x27;, &#x27;Arc_078&#x27;, &#x27;Ocn_115&#x27;, &#x27;NAm_009&#x27;, &#x27;Asi_125&#x27;, &#x27;Eur_013&#x27;, &#x27;Asi_069&#x27;, &#x27;Asi_124&#x27;, &#x27;Asi_196&#x27;, &#x27;Asi_232&#x27;, &#x27;NAm_130&#x27;, &#x27;NAm_104&#x27;, &#x27;Asi_204&#x27;, &#x27;NAm_110&#x27;, &#x27;Arc_061&#x27;, &#x27;Ocn_170&#x27;, &#x27;Ocn_180&#x27;, &#x27;Ocn_154&#x27;, &#x27;Ocn_155&#x27;, &#x27;Asi_090&#x27;, &#x27;Asi_187&#x27;, &#x27;Asi_089&#x27;, &#x27;NAm_029&#x27;, &#x27;Asi_157&#x27;, &#x27;NAm_144&#x27;, &#x27;Asi_164&#x27;, &#x27;Asi_183&#x27;, &#x27;Asi_175&#x27;, &#x27;Asi_088&#x27;, &#x27;Asi_086&#x27;, &#x27;Asi_096&#x27;, &#x27;Ocn_111&#x27;, &#x27;Ocn_112&#x27;, &#x27;NAm_180&#x27;, &#x27;Asi_154&#x27;, &#x27;Ocn_116&#x27;, &#x27;Asi_210&#x27;, &#x27;Asi_072&#x27;, &#x27;Asi_182&#x27;, &#x27;Ocn_130&#x27;, &#x27;Ocn_131&#x27;, &#x27;NAm_159&#x27;, &#x27;Ocn_147&#x27;, &#x27;NAm_094&#x27;, &#x27;Asi_151&#x27;, &#x27;Asi_225&#x27;, &#x27;Arc_064&#x27;, &#x27;Asi_161&#x27;, &#x27;Asi_139&#x27;, &#x27;Ocn_106&#x27;, &#x27;NAm_092&#x27;, &#x27;Arc_030&#x27;, &#x27;Ocn_174&#x27;, &#x27;Asi_199&#x27;, &#x27;Ocn_077&#x27;, &#x27;Asi_046&#x27;, &#x27;Arc_075&#x27;, &#x27;NAm_116&#x27;, &#x27;NAm_163&#x27;, &#x27;Ocn_083&#x27;, &#x27;NAm_097&#x27;, &#x27;Asi_169&#x27;, &#x27;Ocn_160&#x27;, &#x27;SAm_026&#x27;, &#x27;Aus_007&#x27;, &#x27;Ocn_172&#x27;, &#x27;NAm_032&#x27;, &#x27;Asi_032&#x27;, &#x27;Asi_206&#x27;, &#x27;NAm_105&#x27;, &#x27;NAm_184&#x27;, &#x27;Aus_004&#x27;, &#x27;NAm_135&#x27;, &#x27;Arc_011&#x27;, &#x27;Asi_015&#x27;, &#x27;Asi_003&#x27;, &#x27;Asi_165&#x27;, &#x27;Asi_083&#x27;, &#x27;Ant_010&#x27;, &#x27;Asi_197&#x27;, &#x27;Ocn_166&#x27;, &#x27;Asi_156&#x27;, &#x27;Asi_092&#x27;, &#x27;Ocn_123&#x27;, &#x27;Ocn_140&#x27;, &#x27;Ocn_141&#x27;, &#x27;Asi_121&#x27;, &#x27;NAm_190&#x27;, &#x27;Ant_011&#x27;, &#x27;Eur_003&#x27;, &#x27;Asi_172&#x27;, &#x27;Ocn_179&#x27;, &#x27;Asi_141&#x27;, &#x27;Eur_007&#x27;, &#x27;NAm_026&#x27;, &#x27;Asi_189&#x27;, &#x27;Aus_005&#x27;, &#x27;Asi_137&#x27;, &#x27;Ocn_082&#x27;, &#x27;Ocn_066&#x27;, &#x27;Ocn_067&#x27;, &#x27;Asi_107&#x27;, &#x27;Arc_063&#x27;, &#x27;Asi_180&#x27;, &#x27;Ant_007&#x27;, &#x27;Ant_028&#x27;, &#x27;Asi_149&#x27;, &#x27;Asi_024&#x27;, &#x27;Asi_177&#x27;, &#x27;NAm_044&#x27;, &#x27;SAm_029&#x27;, &#x27;Asi_122&#x27;, &#x27;Asi_166&#x27;, &#x27;Ocn_168&#x27;, &#x27;Asi_138&#x27;, &#x27;NAm_045&#x27;, &#x27;Asi_038&#x27;, &#x27;SAm_024&#x27;, &#x27;Asi_048&#x27;, &#x27;Arc_032&#x27;, &#x27;Asi_126&#x27;, &#x27;Asi_142&#x27;, &#x27;Asi_194&#x27;, &#x27;NAm_127&#x27;, &#x27;NAm_140&#x27;, &#x27;NAm_141&#x27;, &#x27;NAm_096&#x27;, &#x27;Ocn_142&#x27;, &#x27;Ocn_143&#x27;, &#x27;Ocn_088&#x27;, &#x27;Arc_077&#x27;, &#x27;Ocn_129&#x27;, &#x27;Ocn_110&#x27;, &#x27;Asi_051&#x27;, &#x27;Arc_002&#x27;, &#x27;Asi_219&#x27;, &#x27;Asi_001&#x27;, &#x27;NAm_007&#x27;, &#x27;Asi_101&#x27;, &#x27;Asi_130&#x27;, &#x27;Asi_132&#x27;, &#x27;Ant_005&#x27;, &#x27;Asi_136&#x27;, &#x27;Ocn_114&#x27;, &#x27;Ocn_081&#x27;, &#x27;Asi_013&#x27;, &#x27;Ocn_176&#x27;, &#x27;NAm_003&#x27;, &#x27;Asi_111&#x27;, &#x27;Asi_002&#x27;, &#x27;Asi_220&#x27;, &#x27;Asi_011&#x27;, &#x27;NAm_185&#x27;, &#x27;NAm_150&#x27;, &#x27;NAm_192&#x27;, &#x27;Asi_145&#x27;, &#x27;Asi_081&#x27;, &#x27;Asi_068&#x27;, &#x27;Asi_229&#x27;, &#x27;NAm_199&#x27;, &#x27;NAm_151&#x27;, &#x27;NAm_152&#x27;, &#x27;Asi_035&#x27;, &#x27;Asi_186&#x27;, &#x27;Ant_003&#x27;, &#x27;NAm_120&#x27;, &#x27;Ocn_120&#x27;, &#x27;Ocn_121&#x27;, &#x27;Ocn_127&#x27;, &#x27;NAm_166&#x27;, &#x27;NAm_167&#x27;, &#x27;Ocn_128&#x27;, &#x27;Asi_158&#x27;, &#x27;NAm_060&#x27;, &#x27;Ant_017&#x27;, &#x27;NAm_081&#x27;, &#x27;NAm_179&#x27;, &#x27;Ocn_074&#x27;, &#x27;Arc_072&#x27;, &#x27;NAm_142&#x27;, &#x27;Asi_104&#x27;, &#x27;Asi_071&#x27;, &#x27;Asi_181&#x27;, &#x27;NAm_160&#x27;, &#x27;Asi_079&#x27;, &#x27;Asi_037&#x27;, &#x27;Ocn_173&#x27;, &#x27;Eur_009&#x27;, &#x27;NAm_117&#x27;, &#x27;NAm_170&#x27;, &#x27;NAm_173&#x27;, &#x27;NAm_174&#x27;, &#x27;Asi_017&#x27;, &#x27;Asi_200&#x27;, &#x27;Asi_190&#x27;, &#x27;Asi_153&#x27;, &#x27;Asi_217&#x27;, &#x27;Asi_082&#x27;, &#x27;Asi_160&#x27;, &#x27;Ocn_118&#x27;, &#x27;Asi_005&#x27;, &#x27;Asi_027&#x27;, &#x27;Asi_195&#x27;, &#x27;Ocn_139&#x27;, &#x27;Ocn_062&#x27;, &#x27;NAm_197&#x27;, &#x27;NAm_168&#x27;, &#x27;NAm_169&#x27;, &#x27;Aus_031&#x27;, &#x27;Asi_059&#x27;, &#x27;NAm_177&#x27;, &#x27;Asi_168&#x27;, &#x27;Asi_102&#x27;, &#x27;Ocn_079&#x27;, &#x27;Arc_020&#x27;, &#x27;Asi_041&#x27;, &#x27;Asi_212&#x27;, &#x27;Ocn_095&#x27;, &#x27;NAm_155&#x27;, &#x27;NAm_064&#x27;, &#x27;Asi_057&#x27;, &#x27;Arc_022&#x27;, &#x27;Ocn_156&#x27;, &#x27;Arc_004&#x27;, &#x27;NAm_131&#x27;, &#x27;NAm_111&#x27;, &#x27;NAm_148&#x27;, &#x27;Asi_216&#x27;, &#x27;NAm_147&#x27;, &#x27;Asi_213&#x27;, &#x27;NAm_008&#x27;, &#x27;NAm_125&#x27;, &#x27;Ocn_107&#x27;, &#x27;Asi_091&#x27;, &#x27;Arc_005&#x27;, &#x27;Arc_068&#x27;, &#x27;NAm_128&#x27;, &#x27;NAm_087&#x27;, &#x27;Ant_019&#x27;, &#x27;NAm_162&#x27;, &#x27;Asi_058&#x27;, &#x27;Asi_192&#x27;, &#x27;Asi_010&#x27;, &#x27;Asi_022&#x27;, &#x27;Asi_112&#x27;, &#x27;Asi_036&#x27;, &#x27;Asi_066&#x27;, &#x27;Asi_021&#x27;, &#x27;NAm_001&#x27;, &#x27;Asi_162&#x27;, &#x27;NAm_030&#x27;, &#x27;Asi_123&#x27;, &#x27;Asi_109&#x27;, &#x27;Asi_074&#x27;, &#x27;Ocn_182&#x27;, &#x27;Asi_143&#x27;, &#x27;Asi_014&#x27;, &#x27;Ocn_162&#x27;, &#x27;Ocn_163&#x27;, &#x27;Ocn_161&#x27;, &#x27;Arc_062&#x27;, &#x27;NAm_172&#x27;, &#x27;Asi_023&#x27;, &#x27;SAm_025&#x27;, &#x27;Ocn_090&#x27;, &#x27;Asi_067&#x27;, &#x27;Ocn_148&#x27;, &#x27;Asi_064&#x27;, &#x27;Asi_103&#x27;, &#x27;NAm_201&#x27;, &#x27;NAm_202&#x27;, &#x27;Asi_134&#x27;, &#x27;Aus_030&#x27;, &#x27;Asi_226&#x27;, &#x27;Asi_063&#x27;, &#x27;NAm_132&#x27;, &#x27;Ocn_119&#x27;, &#x27;Asi_018&#x27;, &#x27;Asi_004&#x27;, &#x27;Asi_031&#x27;, &#x27;Asi_106&#x27;, &#x27;Ocn_109&#x27;, &#x27;Asi_167&#x27;, &#x27;Arc_076&#x27;, &#x27;Asi_114&#x27;, &#x27;NAm_136&#x27;, &#x27;NAm_137&#x27;, &#x27;Asi_127&#x27;, &#x27;NAm_204&#x27;, &#x27;Ant_025&#x27;, &#x27;Asi_131&#x27;, &#x27;NAm_108&#x27;, &#x27;Asi_008&#x27;, &#x27;Arc_016&#x27;, &#x27;Ocn_159&#x27;, &#x27;Ant_004&#x27;, &#x27;Asi_193&#x27;, &#x27;Ocn_087&#x27;, &#x27;NAm_101&#x27;, &#x27;Arc_024&#x27;, &#x27;Ant_021&#x27;, &#x27;Asi_224&#x27;, &#x27;NAm_018&#x27;, &#x27;Arc_073&#x27;, &#x27;Asi_044&#x27;, &#x27;Ant_026&#x27;, &#x27;Asi_227&#x27;, &#x27;NAm_143&#x27;, &#x27;Ocn_153&#x27;, &#x27;Asi_026&#x27;, &#x27;Ocn_169&#x27;, &#x27;Asi_201&#x27;, &#x27;Asi_179&#x27;, &#x27;Ocn_071&#x27;, &#x27;Ocn_072&#x27;]</dd><dt><span>pids_eval :</span></dt><dd>[&#x27;NAm_165&#x27;, &#x27;NAm_145&#x27;, &#x27;NAm_193&#x27;, &#x27;Asi_098&#x27;, &#x27;NAm_086&#x27;, &#x27;Asi_209&#x27;, &#x27;Arc_001&#x27;, &#x27;NAm_122&#x27;, &#x27;Asi_150&#x27;, &#x27;NAm_186&#x27;, &#x27;Asi_108&#x27;, &#x27;Ocn_076&#x27;, &#x27;Asi_029&#x27;, &#x27;Asi_146&#x27;, &#x27;NAm_123&#x27;, &#x27;Ant_012&#x27;, &#x27;Ocn_099&#x27;, &#x27;Asi_128&#x27;, &#x27;Ant_020&#x27;, &#x27;Ocn_178&#x27;, &#x27;Asi_171&#x27;, &#x27;Asi_120&#x27;, &#x27;Asi_065&#x27;, &#x27;Ocn_177&#x27;, &#x27;Ocn_171&#x27;, &#x27;Ocn_108&#x27;, &#x27;NAm_109&#x27;, &#x27;Asi_110&#x27;, &#x27;Ocn_069&#x27;, &#x27;Asi_093&#x27;, &#x27;NAm_158&#x27;, &#x27;Asi_133&#x27;, &#x27;Ocn_098&#x27;, &#x27;NAm_114&#x27;, &#x27;NAm_115&#x27;, &#x27;Asi_042&#x27;, &#x27;Arc_034&#x27;, &#x27;Arc_036&#x27;, &#x27;NAm_129&#x27;, &#x27;Arc_008&#x27;, &#x27;NAm_013&#x27;, &#x27;NAm_011&#x27;, &#x27;NAm_175&#x27;, &#x27;NAm_181&#x27;, &#x27;NAm_088&#x27;, &#x27;Arc_028&#x27;, &#x27;Asi_113&#x27;, &#x27;NAm_095&#x27;, &#x27;NAm_182&#x27;, &#x27;Asi_222&#x27;, &#x27;NAm_106&#x27;, &#x27;Asi_129&#x27;, &#x27;NAm_084&#x27;, &#x27;NAm_146&#x27;, &#x27;Ocn_060&#x27;, &#x27;NAm_126&#x27;, &#x27;Arc_066&#x27;, &#x27;Ocn_122&#x27;, &#x27;Asi_080&#x27;, &#x27;Asi_095&#x27;, &#x27;NAm_195&#x27;, &#x27;NAm_196&#x27;, &#x27;NAm_187&#x27;, &#x27;Arc_033&#x27;, &#x27;Arc_027&#x27;, &#x27;Eur_005&#x27;, &#x27;Asi_039&#x27;, &#x27;Asi_056&#x27;, &#x27;Asi_053&#x27;, &#x27;Asi_205&#x27;, &#x27;Asi_105&#x27;, &#x27;Asi_077&#x27;, &#x27;Arc_065&#x27;, &#x27;Aus_009&#x27;, &#x27;NAm_070&#x27;, &#x27;Ocn_084&#x27;, &#x27;Asi_100&#x27;, &#x27;Ocn_073&#x27;, &#x27;NAm_082&#x27;, &#x27;Asi_163&#x27;, &#x27;Ocn_175&#x27;, &#x27;NAm_107&#x27;, &#x27;NAm_198&#x27;, &#x27;NAm_121&#x27;, &#x27;NAm_138&#x27;, &#x27;NAm_139&#x27;, &#x27;Ant_008&#x27;, &#x27;Arc_074&#x27;, &#x27;Asi_085&#x27;, &#x27;NAm_178&#x27;, &#x27;NAm_083&#x27;, &#x27;NAm_112&#x27;, &#x27;Eur_008&#x27;, &#x27;NAm_118&#x27;, &#x27;NAm_041&#x27;, &#x27;Asi_140&#x27;, &#x27;Asi_159&#x27;, &#x27;Asi_049&#x27;, &#x27;Aus_001&#x27;, &#x27;Ocn_061&#x27;, &#x27;NAm_071&#x27;, &#x27;NAm_119&#x27;, &#x27;Asi_076&#x27;, &#x27;NAm_191&#x27;, &#x27;NAm_164&#x27;, &#x27;Asi_055&#x27;, &#x27;Asi_061&#x27;, &#x27;Ocn_104&#x27;, &#x27;Asi_099&#x27;, &#x27;Ocn_157&#x27;, &#x27;NAm_176&#x27;, &#x27;Asi_188&#x27;, &#x27;Asi_050&#x27;, &#x27;SAm_006&#x27;, &#x27;NAm_059&#x27;, &#x27;Ocn_146&#x27;, &#x27;Asi_016&#x27;, &#x27;Ocn_181&#x27;, &#x27;NAm_200&#x27;, &#x27;NAm_002&#x27;, &#x27;Asi_034&#x27;, &#x27;Asi_054&#x27;, &#x27;Asi_221&#x27;, &#x27;NAm_072&#x27;, &#x27;Asi_118&#x27;, &#x27;Ocn_125&#x27;, &#x27;Asi_211&#x27;, &#x27;Eur_006&#x27;, &#x27;Arc_025&#x27;, &#x27;Arc_018&#x27;, &#x27;Arc_007&#x27;, &#x27;Ocn_097&#x27;, &#x27;Asi_218&#x27;, &#x27;NAm_203&#x27;, &#x27;Asi_207&#x27;, &#x27;NAm_100&#x27;, &#x27;Asi_097&#x27;, &#x27;Asi_208&#x27;, &#x27;Asi_119&#x27;]</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_tas</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">recons</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>
<span class="n">res_tas</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x800 with 2 Axes&gt;, &lt;GeoAxes: title={&#39;center&#39;: &#39;tas, 1&#39;}&gt;)
</pre></div>
</div>
<img alt="../../_images/8dd8a242b9bd7b623038aa9edfc49c7a258a494953d32c7a92ad08b73d15ca7c.png" src="../../_images/8dd8a242b9bd7b623038aa9edfc49c7a258a494953d32c7a92ad08b73d15ca7c.png" />
</div>
</div>
</section>
<section id="validating-our-reconstruction-using-best">
<h3>Validating our reconstruction using BEST<a class="headerlink" href="#validating-our-reconstruction-using-best" title="Link to this heading">#</a></h3>
<p>LMR did their climate field validation against BEST, so we will do the same to get our correlation and CE metrics. The formatting is the same process as above, but wrapping the longitude and alterating time array to be in datetime format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./analyses/BerkeleyEarth/Land_and_Ocean_LatLong1.nc&#39;</span><span class="p">)</span>

<span class="c1"># Convert decimal years to datetime</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="n">year</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">-15&quot;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">])</span>

<span class="c1"># Create a new DataArray with proper coordinates</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span>
        <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span>
    <span class="p">},</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span>
<span class="p">)</span>

<span class="c1"># 3. create ClimateField object</span>
<span class="n">target_be</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ClimateField</span><span class="p">(</span><span class="n">da</span><span class="p">)</span><span class="o">.</span><span class="n">get_anom</span><span class="p">(</span><span class="n">ref_period</span><span class="o">=</span><span class="p">[</span><span class="mi">1951</span><span class="p">,</span> <span class="mi">1980</span><span class="p">])</span>
<span class="n">target_be</span> <span class="o">=</span> <span class="n">target_be</span><span class="o">.</span><span class="n">annualize</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">target_be</span><span class="o">.</span><span class="n">da</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;temperature&#x27; (time: 166, lat: 180, lon: 360)&gt; Size: 43MB
array([[[        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        ...,
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan]],

       [[        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
...
        [ 4.596744  ,  4.5938563 ,  4.5843997 , ...,  4.6102543 ,
          4.6037235 ,  4.597175  ],
        [ 4.673825  ,  4.6759253 ,  4.678038  , ...,  4.6678166 ,
          4.669744  ,  4.6717496 ],
        [ 4.7714734 ,  4.771113  ,  4.7707725 , ...,  4.7726264 ,
          4.7722254 ,  4.7718444 ]],

       [[ 0.3548702 ,  0.35387096,  0.35291004, ...,  0.358096  ,
          0.356983  ,  0.35590762],
        [ 0.10089615,  0.09855123,  0.09632224, ...,  0.10862842,
          0.10593477,  0.10335734],
        [-0.16927919, -0.17242013, -0.1753236 , ..., -0.15843871,
         -0.16228755, -0.16590136],
        ...,
        [-0.1783086 , -0.17734027, -0.18252498, ..., -0.17535889,
         -0.18095711, -0.17951155],
        [ 0.06656009,  0.07851714,  0.09048697, ...,  0.03132993,
          0.04293364,  0.05467859],
        [ 0.17753503,  0.17946205,  0.18142337, ...,  0.17188016,
          0.17373574,  0.17562625]]], dtype=float32)
Coordinates:
  * lat      (lat) float32 720B -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5
  * lon      (lon) float32 1kB -179.5 -178.5 -177.5 -176.5 ... 177.5 178.5 179.5
  * time     (time) int64 1kB 1850 1851 1852 1853 1854 ... 2012 2013 2014 2015
Attributes:
    annualized:  1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'temperature'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 166</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>lon</span>: 360</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-02a8c36e-8f1b-4c2d-98cd-d841c2081352' class='xr-array-in' type='checkbox' checked><label for='section-02a8c36e-8f1b-4c2d-98cd-d841c2081352' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan ... 0.1665 0.1683 0.1701 0.1719 0.1737 0.1756</span></div><div class='xr-array-data'><pre>array([[[        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        ...,
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan]],

       [[        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
...
        [ 4.596744  ,  4.5938563 ,  4.5843997 , ...,  4.6102543 ,
          4.6037235 ,  4.597175  ],
        [ 4.673825  ,  4.6759253 ,  4.678038  , ...,  4.6678166 ,
          4.669744  ,  4.6717496 ],
        [ 4.7714734 ,  4.771113  ,  4.7707725 , ...,  4.7726264 ,
          4.7722254 ,  4.7718444 ]],

       [[ 0.3548702 ,  0.35387096,  0.35291004, ...,  0.358096  ,
          0.356983  ,  0.35590762],
        [ 0.10089615,  0.09855123,  0.09632224, ...,  0.10862842,
          0.10593477,  0.10335734],
        [-0.16927919, -0.17242013, -0.1753236 , ..., -0.15843871,
         -0.16228755, -0.16590136],
        ...,
        [-0.1783086 , -0.17734027, -0.18252498, ..., -0.17535889,
         -0.18095711, -0.17951155],
        [ 0.06656009,  0.07851714,  0.09048697, ...,  0.03132993,
          0.04293364,  0.05467859],
        [ 0.17753503,  0.17946205,  0.18142337, ...,  0.17188016,
          0.17373574,  0.17562625]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-07d78010-8516-4bc5-a624-ff931575f320' class='xr-section-summary-in' type='checkbox'  checked><label for='section-07d78010-8516-4bc5-a624-ff931575f320' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-90a21bd0-99cf-41c7-b2ff-c7bcfca27dfc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-90a21bd0-99cf-41c7-b2ff-c7bcfca27dfc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bbf3dba8-6900-48cb-ba6e-fd55d26f6692' class='xr-var-data-in' type='checkbox'><label for='data-bbf3dba8-6900-48cb-ba6e-fd55d26f6692' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-179.5 -178.5 ... 178.5 179.5</div><input id='attrs-db098d49-49e3-438e-9740-9aac50579e40' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-db098d49-49e3-438e-9740-9aac50579e40' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6887474c-d05f-43ae-a6aa-812031f6899e' class='xr-var-data-in' type='checkbox'><label for='data-6887474c-d05f-43ae-a6aa-812031f6899e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-179.5, -178.5, -177.5, ...,  177.5,  178.5,  179.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1850 1851 1852 ... 2013 2014 2015</div><input id='attrs-dbc99d83-799d-44b4-b89d-a2226a6e9202' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dbc99d83-799d-44b4-b89d-a2226a6e9202' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f5dce60-4794-4a42-b56b-88e020dcee73' class='xr-var-data-in' type='checkbox'><label for='data-4f5dce60-4794-4a42-b56b-88e020dcee73' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1850, 1851, 1852, 1853, 1854, 1855, 1856, 1857, 1858, 1859, 1860, 1861,
       1862, 1863, 1864, 1865, 1866, 1867, 1868, 1869, 1870, 1871, 1872, 1873,
       1874, 1875, 1876, 1877, 1878, 1879, 1880, 1881, 1882, 1883, 1884, 1885,
       1886, 1887, 1888, 1889, 1890, 1891, 1892, 1893, 1894, 1895, 1896, 1897,
       1898, 1899, 1900, 1901, 1902, 1903, 1904, 1905, 1906, 1907, 1908, 1909,
       1910, 1911, 1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920, 1921,
       1922, 1923, 1924, 1925, 1926, 1927, 1928, 1929, 1930, 1931, 1932, 1933,
       1934, 1935, 1936, 1937, 1938, 1939, 1940, 1941, 1942, 1943, 1944, 1945,
       1946, 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957,
       1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969,
       1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981,
       1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
       1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005,
       2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4f75bfe1-5107-4598-b021-8d7eefe4f743' class='xr-section-summary-in' type='checkbox'  ><label for='section-4f75bfe1-5107-4598-b021-8d7eefe4f743' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3d41209c-a45d-4732-b965-bd2f4350f44c' class='xr-index-data-in' type='checkbox'/><label for='index-3d41209c-a45d-4732-b965-bd2f4350f44c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       ...
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-56fda3c3-5961-4257-a712-2c7053499a05' class='xr-index-data-in' type='checkbox'/><label for='index-56fda3c3-5961-4257-a712-2c7053499a05' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-179.5, -178.5, -177.5, -176.5, -175.5, -174.5, -173.5, -172.5, -171.5,
       -170.5,
       ...
        170.5,  171.5,  172.5,  173.5,  174.5,  175.5,  176.5,  177.5,  178.5,
        179.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-71a3b9cd-1cef-4222-b896-6c301aa5d825' class='xr-index-data-in' type='checkbox'/><label for='index-71a3b9cd-1cef-4222-b896-6c301aa5d825' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1850, 1851, 1852, 1853, 1854, 1855, 1856, 1857, 1858, 1859,
       ...
       2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015],
      dtype=&#x27;int64&#x27;, name=&#x27;time&#x27;, length=166))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4dca3c01-6ee2-4c5f-9a9b-521dc34f4128' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4dca3c01-6ee2-4c5f-9a9b-521dc34f4128' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>annualized :</span></dt><dd>1</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert target data to 0-360 format first</span>
<span class="n">target_wrapped</span> <span class="o">=</span> <span class="n">target_be</span><span class="o">.</span><span class="n">wrap_lon</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;360&#39;</span><span class="p">)</span>

<span class="c1"># Then do the comparison (correlation)</span>
<span class="n">valid_fdb</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">recons</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">target_wrapped</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;corr&#39;</span><span class="p">,</span>
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Plot with updated settings</span>
<span class="n">valid_fdb</span><span class="o">.</span><span class="n">plot_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cbar_orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">valid_fdb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;cfr Reproduced v BEST corr(recon, obs), mean=</span><span class="si">{</span><span class="n">valid_fdb</span><span class="o">.</span><span class="n">geo_mean</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;PlateCarree&#39;</span><span class="p">,</span>
    <span class="n">latlon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_proxydb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span>
<span class="p">)</span>

<span class="n">cfr</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/74d80b10fe25c20035571e58c691dd6f40c8d4f4a27188d86ad2ba801cc8e98e.png" src="../../_images/74d80b10fe25c20035571e58c691dd6f40c8d4f4a27188d86ad2ba801cc8e98e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Then do the comparison (CE)</span>
<span class="n">valid_fdbx</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">recons</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">target_wrapped</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;CE&#39;</span><span class="p">,</span>
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Plot with updated settings</span>
<span class="n">valid_fdbx</span><span class="o">.</span><span class="n">plot_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cbar_orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">valid_fdbx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;cfr Reproduced v BEST CE(recon, obs), mean=</span><span class="si">{</span><span class="n">valid_fdbx</span><span class="o">.</span><span class="n">geo_mean</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;PlateCarree&#39;</span><span class="p">,</span>
    <span class="n">latlon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_proxydb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span>
<span class="p">)</span>

<span class="n">cfr</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/82c852c7b75b0061dafb7eb9c43255463b031e389cc856fa135a89ade029b608.png" src="../../_images/82c852c7b75b0061dafb7eb9c43255463b031e389cc856fa135a89ade029b608.png" />
</div>
</div>
</section>
<section id="validating-the-original-lmrv2-1-using-best">
<h3>Validating the original LMRv2.1 using BEST<a class="headerlink" href="#validating-the-original-lmrv2-1-using-best" title="Link to this heading">#</a></h3>
<p>We need to compare both the orignal LMRv2.1 with our reconstruction against the same validation data, in this case, BEST. We will repeat the same steps as above to calculate correlation and CE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lmr_tas</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ClimateField</span><span class="p">()</span><span class="o">.</span><span class="n">load_nc</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./prev_data/air_MCruns_ensemble_mean_LMRv2.1.nc&#39;</span><span class="p">,</span>
    <span class="n">vn</span><span class="o">=</span><span class="s1">&#39;air&#39;</span><span class="p">,</span> 
    <span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>  
    <span class="n">lat_name</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> 
    <span class="n">lon_name</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span>
<span class="p">)</span>

<span class="n">target_lmr</span> <span class="o">=</span> <span class="n">lmr_tas</span><span class="o">.</span><span class="n">get_anom</span><span class="p">(</span><span class="n">ref_period</span><span class="o">=</span><span class="p">[</span><span class="mi">1951</span><span class="p">,</span> <span class="mi">1980</span><span class="p">])</span>
<span class="n">filtered_da</span> <span class="o">=</span> <span class="n">target_lmr</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">target_lmr</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">target_lmr</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ClimateField</span><span class="p">(</span><span class="n">da</span><span class="o">=</span><span class="n">filtered_da</span><span class="p">)</span>
<span class="n">target_lmr</span> <span class="o">=</span> <span class="n">target_lmr</span><span class="o">.</span><span class="n">annualize</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">target_lmr_mean</span> <span class="o">=</span> <span class="n">cfr</span><span class="o">.</span><span class="n">ClimateField</span><span class="p">(</span><span class="n">da</span><span class="o">=</span><span class="n">target_lmr</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;MCrun&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">target_lmr</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;time&#39;, &#39;MCrun&#39;, &#39;lat&#39;, &#39;lon&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Then do the comparison</span>
<span class="n">valid_fdb</span> <span class="o">=</span> <span class="n">target_lmr_mean</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">target_wrapped</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;corr&#39;</span><span class="p">,</span>
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Plot with updated settings</span>
<span class="n">valid_fdb</span><span class="o">.</span><span class="n">plot_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cbar_orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">valid_fdb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;LMRv2.1 v BEST corr(recon, obs), mean=</span><span class="si">{</span><span class="n">valid_fdb</span><span class="o">.</span><span class="n">geo_mean</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;PlateCarree&#39;</span><span class="p">,</span>
    <span class="n">latlon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_proxydb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span>
<span class="p">)</span>

<span class="n">cfr</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5fdf4965fe33b56e63f73b73b4d279ff68f140ce819fb2bd1f3e0431f50a9ef7.png" src="../../_images/5fdf4965fe33b56e63f73b73b4d279ff68f140ce819fb2bd1f3e0431f50a9ef7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Then do the comparison</span>
<span class="n">valid_fdbx</span> <span class="o">=</span> <span class="n">target_lmr_mean</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">target_wrapped</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;CE&#39;</span><span class="p">,</span>
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Plot with updated settings</span>
<span class="n">valid_fdbx</span><span class="o">.</span><span class="n">plot_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cbar_orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">valid_fdbx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;LMRv2.1 v BEST CE(recon, obs), mean=</span><span class="si">{</span><span class="n">valid_fdbx</span><span class="o">.</span><span class="n">geo_mean</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;PlateCarree&#39;</span><span class="p">,</span>
    <span class="n">latlon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_proxydb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span>
<span class="p">)</span>

<span class="n">cfr</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7931aa15d1a188be2172a66c6c06a9b4afa33106229e752d5e2c0c65b5dd138e.png" src="../../_images/7931aa15d1a188be2172a66c6c06a9b4afa33106229e752d5e2c0c65b5dd138e.png" />
</div>
</div>
<p>The spatial correlation and CE maps show that our reproduced LMRv2.1 reconstruction performs nearly identically to the original LMRv2.1, with both having a correlation of 0.36 and a global mean CE of 0.08 when compared against BEST.</p>
<p><strong>Correlation (r)</strong>:
The correlation maps show strong agreement across most of the globe, especially in the tropics, both land and ocean. The patterns look almost exactly the same between the original and reproduced versions, which suggests that the proxy database filtering steps were esential to emulating the reconstruction accurately.</p>
<p><strong>Coefficient of Efficiency (CE)</strong>:
CE is lower overall, which is as expected from the results of the paper, but still positive across most regions. Areas with negative CE are consistent within in both versions. The mean CE of 0.08 is fairly low but is a drastic improvement from negative values from past attempts at emulating LMRv2.1.</p>
<p>Overall, these plots suggest that the reproduced reconstruction preserves the spatial performance of the original and matches the observational target about as well as expected.</p>
</section>
<section id="validating-our-reconstruction-against-original-lmrv2-1">
<h3>Validating our Reconstruction against original LMRv2.1<a class="headerlink" href="#validating-our-reconstruction-against-original-lmrv2-1" title="Link to this heading">#</a></h3>
<p>We validated both against instrumental data, but it is also important to see how our reproduction compares to the original, using the original LMRv2.1 as the target.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Then do the comparison</span>
<span class="n">valid_fdb</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">recons</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">target_lmr_mean</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;corr&#39;</span><span class="p">,</span>
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Plot with updated settings</span>
<span class="n">valid_fdb</span><span class="o">.</span><span class="n">plot_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cbar_orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">valid_fdb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;CFR Reproduced v LMRv2.1 corr(recon, obs), mean=</span><span class="si">{</span><span class="n">valid_fdb</span><span class="o">.</span><span class="n">geo_mean</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;PlateCarree&#39;</span><span class="p">,</span>
    <span class="n">latlon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_proxydb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span>
<span class="p">)</span>

<span class="n">cfr</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0e8ca74e70c296652f02f11d6b36aaf631876ffc53d09307ce71008c5465c4f7.png" src="../../_images/0e8ca74e70c296652f02f11d6b36aaf631876ffc53d09307ce71008c5465c4f7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Then do the comparison</span>
<span class="n">valid_fdb</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">recons</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span>
    <span class="n">target_lmr_mean</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;CE&#39;</span><span class="p">,</span>
    <span class="n">timespan</span><span class="o">=</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Plot with updated settings</span>
<span class="n">valid_fdb</span><span class="o">.</span><span class="n">plot_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cbar_orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">valid_fdb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;CFR Reproduced v LMRv2.1 CE(recon, obs), mean=</span><span class="si">{</span><span class="n">valid_fdb</span><span class="o">.</span><span class="n">geo_mean</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;PlateCarree&#39;</span><span class="p">,</span>
    <span class="n">latlon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_proxydb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span>
<span class="p">)</span>

<span class="n">cfr</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b82f307e754ac4e894fd11256904700ca722dfdfd784e68299d6e8e6492de646.png" src="../../_images/b82f307e754ac4e894fd11256904700ca722dfdfd784e68299d6e8e6492de646.png" />
</div>
</div>
<p>The spatial correlation and CE maps show that the reproduced reconstruction matches the original LMRv2.1 almost perfectly.</p>
<p><strong>Correlation (r)</strong>:
The correlation map has a global mean of 0.94, which is extremely high. Nearly the entire globe is bright red, meaning the two fields match both spatially and in time.</p>
<p><strong>Coefficient of Efficiency (CE)</strong>:
High CE values across most regions show that the reconstruction captures both variability and amplitude much better than a flat mean would. There are very few regions where the reconstruction underperforms the mean baseline, which is another drastic improvement from previous negative CE values.</p>
<p>Again, this confirms that the reproduction is a good match to the original LMRv2.1, both spatially and averaged.</p>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>We reproduced the LMRv2.1 global temperature reconstruction using the PAGES2k proxy database from the <em>cfr</em> package.</p>
<p>To get a close match, we filtered the proxies by both archive type and resolution (dt â‰¤ 1), which brought the number of records closer with those used in the original LMRv2.1.</p>
<p>After validating, the reproduced reconstruction matches the original very closely:</p>
<ul class="simple">
<li><p>Global mean temperature time series align well with instrumental data sets and with the orignal LMRv2.1</p></li>
<li><p>Spatial correlation and CE maps show nearly identical patterns against instrumental data and the orignal LMRv2.1</p></li>
<li><p>There is strong agreement with independent observational targets (HadCRUT5, GISTEMPv4, BEST)</p></li>
</ul>
<p>In future work:</p>
<ul class="simple">
<li><p>More thoroughly explore how different filtering choices in the proxy database affect skill.</p></li>
<li><p>Include additional calibration targets such as precipitation</p></li>
<li><p>Include marine sediments into the proxy network</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/validation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../data_assimilation/C02_b_DA_with_individual_seasonality.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Run Data Assimilation</p>
      </div>
    </a>
    <a class="right-next"
       href="C03_b_comparison.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Proxy Database Forensics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-recon-job">Load Recon Job</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-gmst-from-our-recon-job">Load GMST from our Recon Job</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-lmr-offline-original-lmrv2-1">Load LMR offline (original LMRv2.1)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-both-versions-of-lmr-to-see-comparison">Plot both versions of LMR to see comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-using-pens">Validate Using PENS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-gmst-against-instrumental-datasets">Validating GMST Against Instrumental Datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-against-giss-surface-temperature-analysis-gistemp">Validate against GISS Surface Temperature Analysis (GISTEMP)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-against-hadcrut5">Validate against HadCRUT5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-against-berkeley-earth-surface-temperature-best">Validate against Berkeley Earth Surface Temperature (BEST)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-consensus">Plot Consensus</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-climate-field">Validate Climate Field</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-field-reconstruction">Load field reconstruction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-reproduced">Loading reproduced</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-our-reconstruction-using-best">Validating our reconstruction using BEST</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-the-original-lmrv2-1-using-best">Validating the original LMRv2.1 using BEST</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-our-reconstruction-against-original-lmrv2-1">Validating our Reconstruction against original LMRv2.1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tanaya Gondhalekar, Deborah Khider, Julien Emile-Geay
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>